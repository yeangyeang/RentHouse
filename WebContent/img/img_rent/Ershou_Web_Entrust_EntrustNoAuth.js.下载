var APF={log:function(a){}};APF.Namespace={register:function(d){var c=d.split(".");var a=window;for(var b=0;b<c.length;b++){if(typeof a[c[b]]=="undefined"){a[c[b]]=new Object()}a=a[c[b]]}return a}};APF.Utils={getWindowSize:function(){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return{width:b,height:a}},getScroll:function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return{left:b,top:a}},setCookie:function(c,e,a,h,d,g){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var f=new Date(b.getTime()+(a));document.cookie=c+"="+escape(e)+((a)?";expires="+f.toGMTString():"")+((h)?";path="+h:"")+((d)?";domain="+d:"")+((g)?";secure":"")},getCookie:function(a){var f=document.cookie.split(";");var b="";var d="";var e="";var c=false;for(i=0;i<f.length;i++){b=f[i].split("=");d=b[0].replace(/^\s+|\s+$/g,"");if(d==a){c=true;if(b.length>1){e=unescape(b[1].replace(/^\s+|\s+$/g,""))}return e;break}b=null;d=""}if(!c){return null}},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},setScrollTop:function(a){if(document.body){document.body.scrollTop=a;if(document.body.scrollTop==0){if(document.documentElement){document.documentElement.scrollTop=a}}}else{if(document.documentElement){document.documentElement.scrollTop=a}}},getScrollTop:function(){return document.body?document.body.scrollTop||document.documentElement.scrollTop:document.documentElement.scrollTop},gotoScrollTop:function(f,d){var b=APF.Utils.getScrollTop(),h=0,g=0;var d=d||1;var f=f||0;var a=b>f?1:0;(function(){b=APF.Utils.getScrollTop();h=a?b-f:f-b;g=a?b-h/15*d:b+1+h/15*d;APF.Utils.setScrollTop(g);if(h<=0||b==APF.Utils.getScrollTop()){return}setTimeout(arguments.callee,10)})()}};if(typeof JSON!=="object"){JSON={}}(function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(n){return n<10?"0"+n:n}function this_value(){return this.valueOf()}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};Boolean.prototype.toJSON=this_value;Number.prototype.toJSON=this_value;String.prototype.toJSON=this_value}var gap,indent,meta,rep;function quote(string){rx_escapable.lastIndex=0;return rx_escapable.test(string)?'"'+string.replace(rx_escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);rx_dangerous.lastIndex=0;if(rx_dangerous.test(text)){text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());APF.Namespace.register("ajk");(function(a){ajk.inherit=function(){var f=Array.prototype.splice,c=arguments;var b=c[c.length-1];f.apply(c,[-1,1]);var e=function(){for(var g=0;g<c.length;g++){if(c[g]){c[g].apply(this,arguments)}}b.apply(this,arguments)};for(var d=0;d<c.length;d++){if(c[d]){a.extend(e.prototype,c[d].prototype)}}a.extend(e.prototype,b.prototype);return e};ajk.Observer=function(){this.ob={}};ajk.Observer.prototype.on=function(g,f){var e=g.split(" ");var d={};for(var b=0;b<e.length;b++){if(!this.ob[e[b]]){this.ob[e[b]]=[]}var c=this.ob[e[b]].push(f);d[e[b]]=c-1}return d};ajk.Observer.prototype.off=function(b,d){if(d!==undefined&&!a.isArray(d)){d=[d]}for(var c=0;c<this.ob[b].length;c++){if(d===undefined||a.inArray(c,d)>-1){this.ob[b][c]=undefined}}};ajk.Observer.prototype.trigger=function(c,d){var f;if(!this.ob[c]){return f}var b=d||[];for(var e=0;this.ob[c]&&e<this.ob[c].length;e++){if(!this.ob[c][e]){continue}var g=this.ob[c][e].apply(this,b);f=(f===false)?f:g}return f};ajk.Observer.prototype.once=function(c,e){var b=this;var d=b.on(c,function(){e.apply(this,arguments);b.off(c,d[c])})}})(jQuery);APF.Namespace.register("ajk");(function(){var logger;var siteName=(function(){var hostData=document.location.host.match(/^(\w+)\.(\w+)\./);if(hostData){return"pc"}else{return"unknown"}})();var rAf=function(callback){window.setTimeout(callback,1000/10)};ajk.Logger=logger={sojSite:"",sojPage:"",sojPageName:"",errorSite:siteName};logger.setSite=function(site){this.sojSite=site||""};logger.setPage=function(page){this.sojPage=page||""};logger.setPageName=function(pagename){this.sojPageName=pagename||""};logger.setCtid=function(ctid){this.ctid=ctid||""};logger.config={devLogURL:"//s.anjuke.test/ts.html?",logURL:"//m.anjuke.com/ts.html?",devSojURL:"//s.anjuke.test/stb",isDev:/dev|test/.test(document.domain),blackList:["Player","baiduboxapphomepagetag","onTouchMoveInPage"]};logger.isblack=function(str){var self=this;var i,reg,length,blackList=self.config.blackList;if(typeof str!=="string"){return true}for(i=0,length=blackList.length;i<length;i++){reg=new RegExp(blackList[i],"g");if(reg.test(str)){return true}}};logger.sendError=function(params){var self=this;var errorinfo="tp=error&site="+self.errorSite+"&msg=",key,url,arr=[],image,msg;if(typeof params==="string"){msg=params}if(typeof params==="object"){for(key in params){if(params.hasOwnProperty(key)){arr.push(key+":"+encodeURIComponent(JSON.stringify(params[key])))}}msg=arr.join(",")}if(self.isblack(msg)){return false}image=new Image();if(self.config.isDev){url=self.config.devLogURL+errorinfo+msg}else{url=self.config.logURL+errorinfo+msg}image.src=url;return true};var getScreen=function(){var sinfo={};sinfo.w=$(window).width().toString();sinfo.h=$(window).height().toString();sinfo.r=(window.devicePixelRatio&&window.devicePixelRatio>=2?1:0).toString();getScreen=function(){return sinfo};return sinfo};logger.sendSoj=function(op){var self=this;var _site=op.site||self.sojSite,soj=new SiteTracker(),t_params;if(op.customparam){soj.setCustomParam(op.customparam)}if(self.config.isDev){t_params={target_url:self.config.devSojURL}}var _page=op.page||self.sojPage,_ctid=self.ctid;var _pageName=op.pageName||self.sojPageName||_page;soj.setPage(_page);soj.setPageName(_pageName);soj.setSite(_site);soj.setScreen(getScreen());soj.setNCtid(_ctid);soj.setReferer(op.r||document.referrer);if(op.NGuid){soj.setNGuid(op.NGuid)}if(op.NUid){soj.setNUid(op.NUid)}if(op.h){if(!t_params){t_params={}}t_params.h=op.h}soj.track(t_params);try{if(!/npv/.test(_site)){var trackUrl=soj.getParams();delete trackUrl.cp;delete trackUrl.sc;window._trackURL=JSON.stringify(trackUrl);loadTrackjs()}}catch(e){}function loadTrackjs(){var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src="//tracklog.58.com/referrer_anjuke_pc.js?_="+Math.random();var b=document.body;s.onload=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog");soj.setPageName(_pageName+"_tracklog");soj.track(t_params)};s.onerror=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog_error");soj.setPageName(_pageName+"_tracklog_error");soj.track(t_params)};b.appendChild(s)}};logger.track=function(p,cp,pn){if(!pn){pn=p}if($.isPlainObject(cp)){cp=JSON.stringify(cp)}logger.sendSoj({site:"anjuke-npv",page:p,pageName:pn,customparam:cp||""})};logger.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"_soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})};logger.Exposure=function(op){var defaults={site:"",trackTag:"data-trace",delay:50,page:"",pageName:"",NUid:"",NGuid:"",prefix:""};this.ops=$.extend(defaults,op);this.domCache=[];this.pageViewHeight=$(window).height();this.timer=null;this.dataCache=[];this.expStatus=false;this.init()};logger.Exposure.prototype={constructor:logger.Exposure,add:function(list){var _this=this;this.expStatus=true;list.each(function(index,el){_this.domCache.push($(el))})},init:function(){var wd=$(window),self=this;wd.resize($.proxy(this.resize,this));wd.on("beforeunload",$.proxy(this.beforeunload,this));rAf(scroll);function scroll(){rAf(scroll);if(!self.expStatus){return}clearTimeout(self.timer);if(self.domCache.length===0){self.expStatus=false;self.buildData();return}self.timer=setTimeout(function(){$.proxy(self.addData,self)()},self.ops.delay)}},resize:function(){this.pageViewHeight=$(window).height()},beforeunload:function(){this.buildData()},scroll:function(){},sendExp:function(result){logger.sendSoj({NGuid:this.ops.NGuid,NUid:this.ops.NUid,site:this.ops.site,page:this.ops.prefix+this.ops.page,pageName:this.ops.prefix+this.ops.pageName,customparam:result})},addData:function(){var pageViewHeight=this.pageViewHeight,topY=$(window).scrollTop(),botY=topY+pageViewHeight,_this=this;if(this.domCache.length===0){return}$.each(this.domCache,function(index,val){var _topY,attr;if(!val){return}_topY=val.offset?val.offset().top:0;if(_topY>topY&&_topY<botY){attr=val.attr(_this.ops.trackTag);if(attr){_this.dataCache.push(attr)}delete _this.domCache[index]}});this.buildData()},buildData:function(){var _this=this,result={},r=[],exp,key,length,i;if(this.dataCache.length===0){return}exp=eval("(["+this.dataCache.join(",")+"])");this.dataCache=[];for(i=0,length=exp.length;i<length;i++){for(key in exp[i]){if(!result[key]){result[key]=[]}result[key].push(exp[i][key])}}for(key in result){r.push('"'+key+'":['+result[key].join(",")+"]")}this.sendExp('{"exposure":{'+r.join(",")+"}}");$.each(this.domCache,function(index,val){if(!val){_this.domCache.splice(index,1)}})}};window.onerror=function(msg,url,line){logger.sendError({message:msg,url:url,line:line})};$(function(){logger.addLinkSoj("a[_soj]");if(window.top!==window){$("#trunk").hide()}})})();APF.Namespace.register("ajk");(function(){var a;ajk.DropDown=a=ajk.inherit(ajk.Observer,function(d,c,e){var b=this;b._op=$.extend({},{timer:500},e||{});b._target=d;b._list=c;b._timer;b.isOpen=false;b._bindEvent()});a.prototype._bindEvent=function(){var c=this;var b=function(){c._timer=setTimeout(function(){c.close()},c._op.timer)};c._target.on("mouseenter",function(){if(!c.isOpen){c.open()}});c._target.on("mouseleave",function(){if(c.isOpen){b()}});c._list.on("mouseenter",function(){clearTimeout(c._timer)});c._list.on("mouseleave",function(){if(c.isOpen){b()}});c._list.on("click",function(){c.close()})};a.prototype.open=function(){var b=this;if(b.trigger("open",arguments)!==false){b.isOpen=true;b._list.show()}};a.prototype.close=function(){var b=this;if(b.trigger("close",arguments)!==false){b.isOpen=false;b._list.hide()}}})();APF.Namespace.register("ajk");(function(a){ajk.DataCache=function(c){var b=this;b._cache=[];b.source=c};ajk.DataCache.prototype.get=function(l,k){var m=this,g=[],n=[],h=_.isArray(l)?l:[l];var b=function(o,j){if(!_.isArray(l)){k(o[0],j[0])}else{k(o,j)}};for(var e=0;e<h.length;e++){var c=m.find(h[e]);if(c!==null){g[e]=c}else{n.push({id:e,query:h[e]})}}if(n.length===0){b(g,h);return}for(var d=0,f=0;d<n.length;d++){(function(){var j=n[d];m.source(j.query,function(p){var o=m.add(j.query,p).data;g[j.id]=o;f++;if(f===n.length){b(g,h)}})})()}};ajk.DataCache.prototype.add=function(c,e){var b=this,d={key:c,data:e};b._cache.push(d);return d};ajk.DataCache.prototype.find=function(f){var d=this,c=null,e=0,b=d._cache.length;for(;e<b;e++){if(_.isEqual(d._cache[e].key,f)){c=d._cache[e].data;break}}return c}})(jQuery);APF.Namespace.register("ajk");(function(a){ajk.Autocomplete=ajk.inherit(ajk.Observer,function(c,e){var b='<ul class="auto-ul"><% _.each(obj,function(item){ %><li><span><%= item.keyword %></span><b>约<%= item.num %>套</b></li><%});%><ul>',d={dataSource:function(){},debounce:250,hasCache:true,insertDom:a("body"),template:_.template(b),itemSelector:"li",keySelector:"span",cursorClass:"auto-grayback",wrap:".auto-wrap",emptyFetch:false};this.op=a.extend({},d,e);this.op.wrapStyle=a.extend({},d.wrapStyle,e.wrapStyle);this.el=c;this._init()});ajk.Autocomplete.prototype._init=function(){this.wrap=null;this.sourceChecked=null;this.dataCenter=[];this.keyword=null;this._createWrap();this.resetCursored();this._checkSource();this._delay=false;if(this.op.hasCache){this.dataCache=new ajk.DataCache(this.sourceChecked)}this._bindEvent()};ajk.Autocomplete.prototype._createWrap=function(){if(this.op.wrap.constructor==jQuery){this.wrap=this.op.wrap.eq(0)}else{if(_.isString(this.op.wrap)){var c=a.trim(this.op.wrap);var b=c.substring(0,1);if(b=="."){this.wrap=a('<div class="'+c.slice(1)+'"></div>')}else{if(b=="<"){this.wrap=a(c)}}this.wrap.appendTo(this.op.insertDom)}}};ajk.Autocomplete.prototype._bindEvent=function(){this._onKeyup();this._onMouseover();this._onClick();this._onFocus();this._onBlur();this._isEnterWrap();this._onMousedown()};ajk.Autocomplete.prototype._onKeyup=function(){var b=this;b.el.on("keyup",function(c){b._updateKeyword();switch(c.keyCode){case 35:case 36:case 16:case 17:case 18:case 37:case 39:break;case 40:b.cursor(+1,true);break;case 38:b.cursor(-1,true);break;case 13:if(b.cursorIndex!=-1){b.select(b.wrap.find(b.op.itemSelector).eq(b.cursorIndex))}break;default:b._inputCheck(b.keyword);break}})};ajk.Autocomplete.prototype._isEnterWrap=function(){var b=this;b.wrap.on("mouseover",function(){b._delay=true});b.wrap.on("mouseout",function(){b._delay=false})};ajk.Autocomplete.prototype._onMouseover=function(){var b=this;b.wrap.on("mouseover",b.op.itemSelector,function(){b.cursorIndex=_index=a(this).index();b.cursor(_index)})};ajk.Autocomplete.prototype._onClick=function(){var b=this;b.wrap.on("click",b.op.itemSelector,function(){b.select(a(this))})};ajk.Autocomplete.prototype._onFocus=function(){var b=this;b.el.on("focus",function(){b._updateKeyword();b._inputCheck(b.keyword);if(b.trigger("onfocus",arguments)!==false){b.el.css("border-color","#f60")}})};ajk.Autocomplete.prototype._onMousedown=function(){var b=this;b.wrap.on("mousedown",function(c){c.preventDefault();b.cancelBlur=true;if(b.wrap.find(c.target).length>0){delete b.cancelBlur}})};ajk.Autocomplete.prototype._onBlur=function(){var b=this;b.el.on("blur",function(){if(b.cancelBlur){delete b.cancelBlur;return}if(b.trigger("onblur",arguments)!==false){b.el.css("border-color","#ccc");if(b._delay){setTimeout(function(){b.hide()},150)}else{b.hide()}}})};ajk.Autocomplete.prototype._updateKeyword=function(b){this.keyword=b||this.el.val()};ajk.Autocomplete.prototype._inputCheck=function(b){if(a.trim(b)===""){this.trigger("empty");if(this.op.emptyFetch){this.input(b)}}else{this.input(b)}};ajk.Autocomplete.prototype._checkSource=function(){var b=this;if(a.isFunction(b.op.dataSource)){b.sourceChecked=_.debounce(b.op.dataSource,b.op.debounce)}else{if(a.isArray(b.op.dataSource)){b.sourceChecked=b.op.dataSource}}};ajk.Autocomplete.prototype._updateData=function(){var c=this;if(a.isFunction(c.sourceChecked)){if(c.op.hasCache){c.dataCache.get(c.keyword,b)}else{c.sourceChecked(c.keyword,b)}}else{if(a.isArray(c.sourceChecked)){c.dataCenter=c.sourceChecked;c._render()}}function b(d){c.dataCenter=d;c._render()}};ajk.Autocomplete.prototype._render=function(){this.wrap.html(this.op.template(this.dataCenter));this.resetCursored();if(this.wrap.find(this.op.itemSelector).length>0){this.show()}else{this.hide()}};ajk.Autocomplete.prototype.show=function(){this.wrap.show()};ajk.Autocomplete.prototype.hide=function(){this.wrap.hide()};ajk.Autocomplete.prototype.resetCursored=function(){this.cursorIndex=-1;this.wrap.find(this.op.itemSelector).removeClass(this.op.cursorClass)};ajk.Autocomplete.prototype.cursor=function(f,e){var c=this,j,b,d={},h=arguments[1]===undefined?false:arguments[1],g=c.wrap.find(c.op.itemSelector);if(!h){j=f}else{j=c.cursorIndex+f;if(j>g.length-1){j=0}else{if(j<0){j=g.length-1}}}b=g.eq(j);d={index:j,item:b,data:c.dataCenter[j]};c.cursorIndex=j;if(c.trigger("cursored",[d])!==false){g.removeClass(c.op.cursorClass);b.addClass(c.op.cursorClass)}};ajk.Autocomplete.prototype.select=function(e){var d=this,g=e.index(),f={index:g,item:e,data:d.dataCenter[g]};var c=this.trigger("beforeSelected",[f]);var b=e.find(d.op.keySelector).text();d.el.val(c||b);if(this.trigger("selected",[f])!==false){d.hide()}};ajk.Autocomplete.prototype.input=function(b){if(this.trigger("inputed",arguments)!==false){self.keyword=b;this._updateData()}}})(jQuery);APF.Namespace.register("ajk.UserLogin");(function(){var a;ajk.UserLogin=a=ajk.inherit(ajk.Observer,function(c){var b=this;b._op=$.extend({},{userbox:"#userbox"},c||{});b._userDate=null;b._init()});a.prototype._init=function(){var b=this;b.userbox=$(b._op.userbox);if(APF.Utils.getCookie("aQQ_ajkauthinfos")){b._op.getUserInfo({},function(c){if(c.code===0){b._userDate=c.data;b.updateUserInfo()}b._bindEvent()})}else{b._bindEvent()}};a.prototype._bindEvent=function(){var b=this;if(!b.isLogin()){new ajk.DropDown($(".brokerlogin>.link"),$(".brokerlogin>ul"))}new ajk.DropDown($(".userlogin>.link"),$(".userlogin>ul"))};a.prototype.updateUserInfo=function(){var b=this;if(!b.isLogin()){return}var c=b.getUserHtml();b.userbox.html(c)};a.prototype.isLogin=function(){return this._userDate&&this._userDate.user_id};a.prototype.getUserHtml=function(){var c=this._userDate;var k=c.menu_list;var b="";for(var f=0,d=k.length;f<d;f++){var h=k[f];for(var e=0,l=h.length;e<l;e++){b=b+'<li><a href="'+h[e].url+'">'+h[e].name+"</a></li>"}if(f<d-1){b=b+'<li class="hr"></li>'}}var g='<div class="userlogin userblock userblockfirst"><i class="icon icon-people"></i><a class="link" href="'+c.entry_url+'" rel="nofollow" title="'+c.user_name+'">'+c.user_name+'</a><i class="triangle-down"></i><ul>'+b+"</ul></div>";return g}})();(function(a){a(function(){var b=function(c){var e=c;var d=setTimeout(function(){e.hide()},500);e.data("hiddenTimer",d)};a("#footer").on("click","[data-target]",function(d){d.preventDefault();var c=a(this).data("target");a("#"+c).toggle()});a("#footer").on("mouseout","[data-target]",function(){var c=a(this).data("target");b(a("#"+c))});a("#loan_link, #other_city, #map_link, #house_link, #seo_qa").hover(function(){var c=a(this).data("hiddenTimer");clearTimeout(c)},function(){b(a(this))})})})(jQuery);APF.Namespace.register("ajk.pc");(function($){var sideBar;ajk.pc.sideBar=sideBar=function(op){this._op=$.extend({},{sideBarBox:$(".sidebar"),toTop:$(".sidebar-top"),sidebarNav:$(".sidebar-mod a"),minWidth:1280,minTop:400},op||{});this.init()};sideBar.prototype.init=function(){var self=this;self.addLinkSoj("a[data-soj]");self.checkVisible();$(window).on("scroll resize",function(){self.checkVisible()});self._op.toTop.on("click",function(e){self.sendSoj({site:"anjuke-npv",pn:"track_back_top_click"});$("html,body").animate({scrollTop:0},100)});$("#sid_survey").on("click",function(){self.sendSoj({site:"anjuke-npv",pn:"track_survey_click"})})};sideBar.prototype.checkVisible=function(){var self=this,winWidth=$(window).width(),scrollTop=$(window).scrollTop();if(winWidth>self._op.minWidth){self._op.sideBarBox.show();self._op.sideBarBox.stop().animate({right:"0px"},100);self._op.toTop.removeClass("sd-top-sig")}else{self._op.sideBarBox.stop().animate({right:"-40px"},100);self._op.toTop.addClass("sd-top-sig")}if(scrollTop>self._op.minTop){self._op.toTop.show()}else{self._op.toTop.hide()}self.slideNav()};sideBar.prototype.slideNav=function(){var self=this;self._op.sidebarNav.hover(function(){var hoverWidth=$(this).children(".sidebar-nav-hover").hasClass("sidebar-sao")?"130px":"90px";$(this).children(".sidebar-nav-hover").stop().animate({width:hoverWidth},100)},function(){$(this).children(".sidebar-nav-hover").stop().animate({width:"0px"},100)})};sideBar.prototype.sendSoj=function(op){var self=this;if(ajk&&ajk.Logger){ajk.Logger.sendSoj({page:op.pn,site:op.site,pageName:op.pn})}else{if(J&&J.site&&J.site.trackEvent){J.site.trackEvent(op.pn)}}};sideBar.prototype.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"data-soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})}})(jQuery);APF.Namespace.register("ajk.inherit");ajk.inherit=function(){var e=Array.prototype.splice,b=arguments;var a=b[b.length-1];e.apply(b,[-1,1]);var d=function(){for(var f=0;f<b.length;f++){if(b[f]){b[f].apply(this,arguments)}}a.apply(this,arguments)};for(var c=0;c<b.length;c++){if(b[c]){$.extend(d.prototype,b[c].prototype)}}$.extend(d.prototype,a.prototype);return d};ajk.Observer=function(){this.ob={}};ajk.Observer.prototype.on=function(f,e){var d=f.split(" ");var c={};for(var a=0;a<d.length;a++){if(!this.ob[d[a]]){this.ob[d[a]]=[]}var b=this.ob[d[a]].push(e);c[d[a]]=b-1}return c};ajk.Observer.prototype.off=function(a,c){if(c!==undefined&&!$.isArray(c)){c=[c]}for(var b=0;b<this.ob[a].length;b++){if(c===undefined||$.inArray(b,c)>-1){this.ob[a][b]=undefined}}};ajk.Observer.prototype.trigger=function(b,c){var e;if(!this.ob[b]){return e}var a=c||[];for(var d=0;this.ob[b]&&d<this.ob[b].length;d++){if(!this.ob[b][d]){continue}var f=this.ob[b][d].apply(this,a);e=(e===false)?e:f}return e};ajk.Observer.prototype.once=function(b,d){var a=this;var c=a.on(b,function(){d.apply(this,arguments);a.off(b,c[b])})};(function(){var a;APF.Namespace.register("ajk.Connect");ajk.Connect=a=function(){var b=this;b._key=0;b._final=null;b._stack=[]};a.prototype.next=function(b){this._stack.push(b);return this};a.prototype.allDone=function(b){this._final=b;return this};a.prototype._handle=function(c){var d=this;var f=d._stack[d._key]||d._final;if(!f){return}var e=function(){if(d._key==d._stack.length){return}d._key++;d._handle(c)};var b=c.concat([e]);f.apply(d,b)};a.prototype.start=function(){var c=this;var b=_.toArray(arguments);c._key=0;c._handle(b)}})();(function(){var b;APF.Namespace.register("ajk.Validate");ajk.Validate=b=ajk.inherit(ajk.Observer,function(e,d){var c=this;c._form=e;c._checkList=[];c._op=$.extend({},b._config_,d||{});c._init()});b._config_={rules:[],eventNameSpace:"validate",checkEventType:"blur",selectEventType:"change",checkboxEventType:"click",ignoreList:[],singleHandle:function(c){},submitHandle:function(c,d){if(c){this._form.off("submit.validate").submit()}else{var e=d.dom;if(!e.focus){e=$('[data-group="'+e+'"]')}e.focus()}}};b._rulesCheckbox_={required:function(c){return c.filter(":checked").length>0},maxNumber:function(d,c){return d.filter(":checked").length<=c}};b._rulesText_={required:function(c){var d=c;return d.length>0},integer:function(c){var d=c;return/^\-?[\d]*$/.test(d)},equal:function(c,d){var e=c;return e===d},not:function(d,c){var e=d;if(d==""){return e!==c}else{return e!=c}},maxLength:function(d,c){var e=d;return e.length<=c},minLength:function(d,c){var e=d;return e.length>=c},max:function(d,c){var e=d-0;return e-c<=0},min:function(d,c){return d-0-c>=0},mobile:function(c){var d=c;return/^1\d{10}$/.test(d)},email:function(c){var d=c;return/^[a-z0-9_-]+@[a-z0-9_-]+\.\w{2,3}$/i.test(d)},ucode:function(c){var d=c;return/^[U]{0,1}\d{12}$/.test(d)},number:function(c){var d=c;return !isNaN(d)},depend:function(d,f,c){var e=$('[name="'+f+'"]');this.check(e,false,function(g){c(g.status=="success"?true:false)})},numOrLetter:function(c){var d=c;return d==""||/^[a-z0-9]+$/i.test(d)},decimal:function(e,d){var f=e;var c=e.split(".");if(c[1]){return c[1].length<=d}else{return true}},repeatNumber:function(e,c){var d=new RegExp("[0-9]{"+c+",}");var f=d.test(e);return !f},invalidChar:function(e,c){var d=new RegExp("[@#$%￥…]{"+c+",}");var f=d.test(e);return !f}};b.prototype._init=function(){var c=this;c._form.on("submit.validate",function(d){d.preventDefault();c.checkAll(c._op.submitHandle)})};b.prototype._getCheckEvent=function(f){var d=this;var e=f.filter("select").length>0?"select":f.attr("type");var c="";switch(e){case"checkbox":c+=d._op.checkboxEventType;break;case"radio":c+=d._op.checkboxEventType;break;case"select":c+=d._op.selectEventType;break;default:c+=d._op.checkEventType}return c+"."+d._op.eventNameSpace;d._checkEvent=d._op.checkEventType};b.prototype._ruleWrap=function(e,d){var g=d||b._rulesText_;var f=g[e.rule];var c=e.arg;if(e.rule=="depend"){return f}return function(k,j,l){var h=f(k,j);l(h)}};b.prototype._check=function(e,h){var k=this;var c=$.Deferred();var l=new ajk.Connect();var d=(typeof e=="string")?e:e.attr("name");var g=(typeof e=="string")?"":$.trim(e.val());if(k._op.getValue&&k._op.getValue[d]){g=k._op.getValue[d]()}var j=!!_.find(h,function(m){return m.rule=="required"});if(!(typeof e=="string")&&!j){l.next(function(m,n){if(g.length<=0){c.resolve({status:"success",dom:e,value:g})}else{n()}})}for(var f=0;f<h.length;f++){(function(){var n=h[f];var m=function(t){var r=(typeof t=="string")?e:t.attr("type");var p=(r=="radio"||r=="checkbox");var o=p?b._rulesCheckbox_:b._rulesText_;var s=$.isFunction(n.rule)?n.rule:k._ruleWrap(n,o);var q=p?t:g;return function(u){s.call(k,q,n.arg,u)}};l.next(function(o,p){m(e)(function(r){if(r){p()}else{var q=_.toArray(arguments);q[0]=g;c.reject({status:"error",dom:e,value:g,msg:$.isFunction(n.msg)?n.msg.apply(e,q):n.msg})}})})})()}l.allDone(function(){c.resolve({status:"success",dom:e,value:g})});l.start(g);return c.promise()};b.prototype._getRules=function(e){var c=this;var d=(typeof e=="string")?e:e.attr("name");return _.find(c._checkList,function(f){return f.key==d})};b.prototype.check=function(h,k,j){var c=this;var g=(typeof h=="string");var e=c._getRules(h);var d=(g)?h:h.val();var f=(function(){var o=g?undefined:h.data("checkflow");var m=g?"group":h.attr("type");var l=(m=="radio"||m=="checkbox");if(!k&&!l&&o&&o.value==d){return o.dtd}else{c._beginCheck(e);var n=c._check(e.dom,e.rules);if(!g){h.data("checkflow",{value:d,dtd:n})}return n}})();if(j){f.always(j)}return f};b.prototype.checkAll=function(e){var c=this;var d=c._ignore(c._checkList);return c._buildCheckFlow(d)(e)};b.prototype.checkAsList=function(e,f){var c=this;var d=_.filter(c._checkList,function(g){return $.inArray(g.key,e)>-1});return c._buildCheckFlow(d)(f)};b.prototype.resetCheckResult=function(d){var c=this;var e=$('[name="'+d+'"]');if(e.length>=1){e.removeData("checkflow")}c._op.singleHandle.apply(c,[{status:"reset",name:d,dom:e.length>=1?e:d}]);c.trigger("reset",[d,e])};b.prototype.addIgnoreList=function(c,e){var d=this;if(e){d._op.ignoreList=c}else{d._op.ignoreList=_.union(d._op.ignoreList,c)}_.each(c,function(f){d.resetCheckResult(f)})};b.prototype.removeIgnoreList=function(c){var d=this;if(c){d._op.ignoreList=_.difference(d._op.ignoreList,c)}else{d._op.ignoreList=[]}};b.prototype._ignore=function(e){var c=this;var d=_.filter(e,function(f){return _.indexOf(c._op.ignoreList,f.key)==-1});return d};b.prototype._buildCheckFlow=function(e){var c=this;var d=!e?c._checkList:e;return function(l){var j=[];for(var h=0;h<d.length;h++){j.push(c.check(d[h].dom,false,function(f){c._checkResult(f)}))}var g=true;var k=$.when.apply($,j);return k.fail(function(){g=false}).always(function(f){l.apply(c,[g,f])})}};b.prototype._checkResult=function(d){var c=this;c._op.singleHandle.apply(c,[d]);c.trigger(d.status,arguments)};b.prototype._beginCheck=function(d){var c=this;c._op.singleHandle.apply(c,[{status:"check",dom:d.dom,data:d}]);c.trigger("check",arguments)};b.prototype.initRules=function(){var l=this;var g=l._form.find("input,textarea,select");l._checkList=[];for(var h=0;h<g.length;h++){var j=g.eq(h);var c=j.attr("name");var k=j.data("group");if(j.data("rules")||l._op.rules[c]){var e=l._buildRules(j);if(k){var f=l._buildRules(k)}var d=l._getCheckEvent(j);e.dom.off(d).on(d,function(){var o=$(this);var m=o.attr("name");if($.inArray(m,l._op.ignoreList)<0){l.check(o,false,function(p){l._checkResult(p)})}var n=o.data("group");if(n&&$.inArray(n,l._op.ignoreList)<0){l.check(n,false,function(p){l._checkResult(p)})}})}}};var a=function(f,d){var e=_.pluck(f,"rule");var c=_.filter(d,function(g){return $.inArray(g.rule,e)<0});return f.concat(c)};b.prototype._buildRules=function(h){var d=this;var j=(typeof h=="string");var f=j?h:h.attr("name");var g=_.find(d._checkList,function(k){return k.key==f});if(!g){if(!j&&(h.attr("type")=="checkbox"||h.attr("type")=="radio")){h=$('[name="'+f+'"]')}g={key:f,dom:j?f:h,rules:[]};d._checkList.push(g)}if(!j){var c=d._getRulesByData(h);g.rules=a(g.rules,c)}var e=d._getRulesByOption(f);g.rules=a(g.rules,e);return g};b.prototype._getRulesByData=function(g){var f=g.data("rules");var c=g.data("msgs");var d=[];for(var e in f){d.push({rule:e,arg:f[e],msg:c[e]})}return d};b.prototype._getRulesByOption=function(d){var c=this;return c._op.rules[d]||[]}})();(function(){var b={};var e=function(f,g){b[f]=g};var a=function(f){return $("[data-msgfor]").filter(function(h){var j=$(this);var g=j.data("msgfor").split(",");return $.inArray(f,g)>-1})};var c=function(h){var g=a(h);var k="";if(g.length<=0){throw ("表单验证展示错误："+h+"字段找不到信息提示框(通过在标签上添加属性 data-msgfor 设置)")}var f=g.data("msgfor").split(",");var j=_.filter(f,function(l){if(k==""&&b[l]){k=b[l]}var m=$('[name="'+l+'"]');return !(m.length<=0||m.prop("disabled"))});return{msg:k,place:g,placeTarget:j}};var d=function(j,g){var h=c(j);var f=false;for(var k=0;k<h.placeTarget.length;k++){if(b[h.placeTarget[k]]===undefined){f=true;break}}var l="";if(h.msg.length>0){l+='<i class="icon ico-hint"></i>'+h.msg;h.place.addClass("ui-tips-fail-noborder").removeClass("ui-tips-success-noborder")}else{if(!f){h.place.addClass("ui-tips-success-noborder").removeClass("ui-tips-fail-noborder")}}h.place.html(l).show()};$.extend(ajk.Validate._config_,{singleHandle:function(g){var h=typeof g.dom=="string"?g.dom:g.dom.attr("name");if(g.status=="success"||g.status=="error"){if(g.status=="success"){e(h,"")}else{e(h,g.msg)}d(h,this._checkList);var f=({success:"removeClass",error:"addClass"})[g.status];if(typeof g.dom!="string"){g.dom[f]("ui-form-input-error")}}if(g.status=="reset"){if(typeof g.dom!="string"){g.dom.removeClass("ui-form-input-error")}e(g.name,undefined);d(h,this._checkList)}}})})();APF.Namespace.register("ajk");(function(a){var b=ajk.Roller=ajk.inherit(ajk.Observer,function(e){var c='<div class="exia-box" style="height:<%= height %>px"><div class="sol-label"><span data-val="" data-title="<%= title %>" style="height:<%= height %>px"><%= title %></span><i style="top:<%= top %>px" class="icon icon-seldown"></i></div><ul style="width:<%= width %>px;top:<%= height %>px;"></ul></div>';var f='<li style="height:<%= height %>px;line-height:<%= height %>px;" data-val="<%= value %>"><%= desc %></li>';var d='<option value="<%= value %>"><%= desc %></option>';this.op=a.extend({boxId:"selectbox",zcord:1,trigger:"click",title:undefined,onchange:undefined,crTpl:_.template(c),imTpl:_.template(f),slTpl:_.template(d),rrClass:"exia-box",teClass:"exia-light",downClass:"icon-seldown",upClass:"icon-selup",liClass:"li-over",liStClass:"li-static",labelClass:"sol-label",resetValue:undefined,triggerChange:true,onchange:function(){},onLabelClick:function(){}},e);this.effective=true;this.container=a("#"+this.op.boxId);this.originSel=this.container.find("select");this.initial()});b.prototype.initial=function(){this.drawRoller();this.bindEvent();this.press(0,true)};b.prototype.drawRoller=function(){var l=this,d=this.container,h=d.children("select"),k=l.op.rrClass;var j=d.innerHeight()-2;var e=d.innerWidth()-2;var g=Math.ceil((j-7)/2);var c=l.op.crTpl({value:h.val(),title:l.op.title||h.find("option:first").text(),height:j,width:e,top:g});d.append(c);var f="";h.children("option").each(function(m,o){var n=a(o).prop("value"),p=a(o).text();f+=l.op.imTpl({height:j+2,desc:p,value:n})});d.find("."+k+" ul").append(f)};b.prototype.bindEvent=function(){var c=this;var f=this.container;var d=c.op.rrClass;var e=f.find("."+d);e.bind(c.op.trigger,function(g){var h=a(g.srcElement||g.target);if(g.type=="mouseout"||g.type=="mouseleave"&&!e.find("ul").is(":visible")){return}e.find("ul").is(":visible")?f.css("zIndex",c.op.zcord):f.css("zIndex","999");e.find("i").toggleClass(c.op.downClass+" "+c.op.upClass);e.find("ul").toggle();e.toggleClass(c.op.teClass)});f.on("click","."+d+" li",function(g){c.handlePress(a(this))});f.on("click","."+c.op.labelClass+" span",function(){var g=a(this).data("val");c.op.onLabelClick(g)});f.on("mouseover mouseleave","."+d+" li",function(g){a(this).toggleClass(c.op.liClass)});if(c.op.trigger=="click"){a("body").on("click",function(g){var h=a(g.srcElement||g.target);if(!h.parents("#"+c.op.boxId).length&&!h.is("#"+c.op.boxId)&&e.find("ul").is(":visible")){c.shrink()}})}};b.prototype.shrink=function(){var c=this;var f=this.container;var d=c.op.rrClass;var e=f.find("."+d);f.css("zIndex",c.op.zcord);e.children("ul").hide();e.removeClass(c.op.teClass);e.find("i").removeClass(c.op.upClass).addClass(c.op.downClass)};b.prototype.handlePress=function(g,c){var l=this;var d=this.container;var j=l.op.rrClass;var e=d.find("."+j);var k=g,f=k.text(),h=k.attr("data-val");if(l.op.resetValue&&l.op.resetValue==h){f=l.op.title}e.find("."+l.op.labelClass+" span").attr("data-val",h).html(f);k.siblings().removeClass(l.op.liStClass);k.addClass(l.op.liStClass);l.originSel.val(h);if(l.op.triggerChange){l.originSel.change()}!c&&l.op.onchange(h);l.shrink()};b.prototype.press=function(e,h){var c=this;var g=this.container;var d=c.op.rrClass;var f=g.find("."+d);c.handlePress(f.children("ul").find("li:eq("+e+")"),h)};b.prototype.valid=function(c){this.effective=c};b.prototype.val=function(g,h){var d=this,f=this.container,c=d.op.labelClass,e=f.find("."+c);if(g!=undefined){e.next().find("li").each(function(j,k){if(a(k).attr("data-val")==a.trim(g)){d.press(j,h)}});return d}else{return e.children("span").attr("data-val")}};b.prototype.reset=function(c,e){var g="",h="";var f=this.container;var j=f.innerHeight();var l=this.op.labelClass;var k=f.find("."+l);for(var d=0;d<c.length;d++){g+=this.op.imTpl({height:j,value:c[d].value,desc:c[d].desc});h+=this.op.slTpl({value:c[d].value,desc:c[d].desc})}k.children("span").attr("data-title",c[0].desc);k.next().html(g);this.originSel.html(h);this.press(0,e)}})(jQuery);(function(c,a){a.flashChecker=function(){var f=0,h=0,k,m;try{k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(k){f=1;m=k.GetVariable("$version");h=parseInt(m.split(" ")[1].split(",")[0])}}catch(n){if(navigator.plugins&&navigator.plugins.length>0){k=navigator.plugins["Shockwave Flash"];if(k){f=1;var o=k.description.split(" ");for(var j=0,g=o.length;j<g;++j){if(isNaN(parseInt(o[j]))){continue}h=parseInt(o[j])}}}}if(f===1&&h>=10){return true}else{return false}};var d={isInstallFlash:a.flashChecker(),isSupportXhrFileUpload:!!(window.ProgressEvent&&window.FileReader),isSupportFormData:!!window.FormData,isSupportMultiUpload:"multiple" in document.createElement("input")},b={success:0,length:1,size:2,security:3,graphics_size:4,support:5,file_type:6,defaults:10};a.ImageUpload=a.inherit(a.Observer,function(f){var e={fileDataName:"file",multi:true,auto:false,multiLength:10,sizeLimit:3145728,fileDesc:"",fileExt:"*.jpg;*.JPG;*.png;*.PNG;*.jpeg;*.JPEG;",width:144,height:109,buttonText:"文件上传",simUploadLimit:20,queueID:"",fileType:"image",buttonImg:"",cancelImg:"",minSize:null,maxSize:null,minheight:null,minwidth:null,model:0};this.op=c.extend({},e,f);this.status=true;this.model=this.op.model;this.remainLength=this.op.multiLength;this.dom=c(this.op.target);this._init()});a.ImageUpload.prototype=c.extend({},a.ImageUpload.prototype,{constructor:a.ImageUpload,switchServer:function(e){this.op.uploader=e;this._init()},setImageUploadsSize:function(e){this.op.multiLength=e;this.remainLength=e},setUploadImageStatus:function(e){var f="disable";this.status=e;if(d.isInstallFlash===false){if(e){f="enable"}this.dom.fileupload(f)}},switchModle:function(e){this.model=e;this._init();if(e===0){if(d.isInstallFlash===false){this.trigger("error",[{status:b.support}])}}else{this._javasciptUpload()}},getRemainUploadImageSize:function(){return this.remainLength},_init:function(){this.dom.off();this.dom.siblings("object").remove();if(d.isInstallFlash&&this.model===0){this._flashUpload();return}else{this._javasciptUpload()}},_javasciptUpload:function(){var g=this;var e=g.dom.attr("id");var f={url:g.op.uploader,secureuri:false,rt:g.op.redirect,dataType:"json",fileElementId:g.dom.attr("id"),success:function(j,h){g.checkFileInfo(j)},error:function(){g.trigger("error",[{status:b.defaults}])},complete:function(){g.dom.replaceWith('<input type="file" id="'+e+'" name="file" value="上传图片" accept="image/*" />');c("#"+e).change(function(){c.ajaxFileUpload(f)})}};g.dom.change(function(){if(g.checkFileLength(1)===false){return}else{c.ajaxFileUpload(f)}});g.dom.show()},_flashUpload:function(){var e=this;this.dom.uploadify({uploader:e.op.swfUrl,script:e.op.uploader,scriptAccess:"always",fileDataName:e.op.fileDataName,multi:e.op.multi,auto:e.op.auto,sizeLimit:e.op.sizeLimit,fileDesc:e.op.fileext,fileExt:e.op.fileext,width:e.op.width,height:e.op.height,buttonText:e.op.buttonText,simUploadLimit:e.op.simUploadLimit,queueID:e.op.queueID,fileType:e.op.fileType,buttonImg:e.op.buttonImg,cancelImg:e.op.cancelImg,onInit:function(){},onSelect:function(f,g){},onComplete:function(j,f,h,g,k){var l=c.parseJSON(g);e.checkFileInfo(l)},onError:function(k,g,j,h){var l=h.type,f=0;switch(l){case"File Size":f=b.size;break;case"Security":f=b.security;break;default:f=b.defaults;break}try{e.dom.uploadifyCancel(g)}catch(m){}e.trigger("error",[{status:f}])},onAllComplete:function(){},onQueueFull:function(f,g){e.trigger("error",[{status:b.defaults}])},onSelectOnce:function(f,g){if(e.status===false){return}if(e.checkFileLength(g.fileCount)===false){return false}e.dom.uploadifyUpload()}})},checkFileInfo:function(g){if(!g||g.status!=="ok"){this.trigger("error",[{status:b.defaults}]);return false}if(this.op.fileExt.indexOf(g.image.format)==-1){this.trigger("error",[{status:b.file_type}]);return}if(this.op.minheight&&this.op.minwidth>0){if(g.image.width<this.op.minwidth||g.image.height<this.op.minheight){if(d.isInstallFlash){try{this.dom.uploadifyCancel(this.op.queueID)}catch(f){}}this.trigger("error",[{status:b.graphics_size}]);return false}}if(this.op.minSize>0||this.op.maxSize>0){if(g.image.size<=this.op.minSize||g.image.size>=this.op.maxSize){if(d.isInstallFlash){try{this.dom.uploadifyCancel(this.op.queueID)}catch(f){}}this.trigger("error",[{status:b.size}]);return false}}if(this.trigger("success",[g])!==false){this.remainLength--}},checkFileLength:function(e){if(this.remainLength<=0){if(d.isInstallFlash){this.dom.uploadifyClearQueue()}this.trigger("error",[{status:b.length,limit:this.remainLength,current:e}]);return false}if(e>this.remainLength){if(d.isInstallFlash){this.dom.uploadifyClearQueue()}this.trigger("error",[{status:b.length,limit:this.remainLength,current:e}]);return false}if(this.trigger("select",[e])===false){return false}return true}});a.ImageUpload.Utils=d;a.ImageUpload.Status=b})(jQuery,ajk);(function(b){var a=ajk.MultiUpload=ajk.inherit(ajk.Observer,function(c){this.uploader=c.uploader;this.boxTemplate=c.boxTemplate;this.loadingTemplate=c.loadingTemplate;this.wrap=c.wrap;this.maxCount=c.maxCount;this.mainInput=c.mainInput;this._bindEvent()});a.prototype._bindEvent=function(){var c=this;c.uploader.on("select",function(e){b(".img-err").hide();var d="";var h=c.loadingTemplate();for(var f=0;f<e;f++){d+=h}c.wrap.find(".uploader-content").before(d);var j=c.wrap.parents(".upload").attr("data-track")||"";if(j!=""){var g=new SiteTracker("anjuke-npv");g.setCustomParam("{"+j+"}");g.track()}});c.uploader.on("success",function(e){b(".img-err").hide();c.wrap.find(".upload-box-loading").remove();var f=c._produceObject(e);var d=c.addImage(f);if(d){c.trigger("add",[f])}setTimeout(function(){c.checkEnough()},0);if(c.uploader.op.isExecute){ajk.uploadExternalCallFn()}return d});c.uploader.on("error",function(d){c.wrap.find(".upload-box-loading").remove();if(d.status=="1"){c.showErr("抱歉，最多只能上传"+c.maxCount+"张图片")}else{if(d.status=="2"){c.showErr("请上传小于3M的图片")}else{if(d.status=="6"){c.showErr("上传失败，图片格式不符合规定")}else{if(d.status=="4"){c.showErr("请上传大于"+c.uploader.op.minwidth+"*"+c.uploader.op.minheight+"px的图片")}else{c.showErr("图片上传失败，请重试")}}}}c.checkEnough()});c.wrap.on("click",".set-delete",function(){var d=b(this).parents(".upload-box");var e=d.data("id");c.deleteById(e)})};a.prototype._produceObject=function(c){return{src:"//pic1.ajkimg.com/display/anjuke/"+c.image.id+"/100x75c.jpg",exif:JSON.stringify(c.image),id:c.image.id,host:c.image.host}};a.prototype._checkUnique=function(c){var d=c.id;return b(".upload-pictures").find('[data-id="'+d+'"]').length==0};a.prototype.checkList=function(){var d=this.wrap.find(".upload-box");var c=[];if(d.length<=1){d.find(".set-prev,.set-next").hide()}else{d.find(".set-prev,.set-next").show();d.eq(0).find(".set-prev").hide();d.eq(d.length-1).find(".set-next").hide()}d.each(function(){c.push({src:b(this).find("img").attr("src"),id:b(this).data("id"),exif:b(this).find(".hideupd").val()})});return c};a.prototype.checkEnough=function(){if(this.uploader.remainLength==0){this.wrap.find(".uploader-main").hide()}else{this.wrap.find(".uploader-main").show()}};a.prototype.addImage=function(f){var d=this;if(d.uploader.remainLength<=0){d.showErr("抱歉，最多只能上传"+d.maxCount+"张图片");return false}if(d._checkUnique(f)){var c=d.boxTemplate(f);d.wrap.find(".uploader-content").before(c);d.checkEnough();return true}else{var e=d.uploader.remainLength;d.showErr("已经上传该图片，不能重复上传");return false}};a.prototype.showErr=function(c){b(".img-err").show().find("em").html(c);return false};a.prototype.deleteById=function(e){var c=this;if(!e){return}var d=_.isArray(e)?e:[e];_.each(d,function(h,f){var g=c.wrap.find('[data-id="'+h+'"]');if(g.length>0){g.remove();c.uploader.setImageUploadsSize(c.uploader.remainLength-0+1)}c.checkEnough()})}})(jQuery);APF.Namespace.register("EntruseNoAuth");(function(b){var a=EntruseNoAuth=function(c){this.op=b.extend({},c);this.item={inputs:b("input.int-text, textarea"),msgBtn:b(".getcode"),refresh:b(".refresh"),codeImg:b(".vimg"),subBtn:b("#submit-btn"),formBox:b("#entrust-form"),successBox:b(".entrust-success"),failBox:b(".entrust-fail"),xqNameInput:b('input[name="xq_name"]'),xqIdInput:b('input[name="xq_id"]'),buildingInput:b('input[name="building"]'),unitInput:b('input[name="unit"]'),roomDecorateInput:b('input[name="room_decorate"]'),housePicInput:b('input[name="house_pic"]'),phoneInput:b('input[name="phone"]'),codeInput:b('input[name="code"]'),vcodeInput:b('input[name="vcode"]'),xqAddrInput:b('input[name="xq_addr"]'),xqAddress:b(".villiage-address"),codeBox:b(".code-item"),vcodeBox:b(".vcode-item"),landlordNote:b("#landlord-note"),xqNameBox:b(".xq-item")};this.isSend=true;this.hasCashedTrueVal="";this.hasCashedId="";this.init()};a.prototype={init:function(){this.initValidate();this.acts();this.searchXq();this.trackEvents();if(this.item.housePicInput.length){var d=this.item.housePicInput;var c=this.item.housePicInput.parents("li").find(".com-msg");ajk.uploadExternalCallFn=function(){var e=b(".upload-box").length;d.val(e);c.hide()}}},acts:function(){var c=this;c.item.inputs.on({focus:function(){if(b(this).val()==b(this).attr("placeholder")){b(this).val("")}b(this).addClass("int-focus")},blur:function(){b(this).removeClass("int-focus")}});c.item.phoneInput.on("keyup input",function(){c.item.msgBtn.addClass("getcode-dis");if(b(this).val().length==11){c._validate.checkAsList(["phone"],function(d){if(!d){return}c.checkSendStatus()})}});if(c.op.phoneNum){c.item.phoneInput.val(c.op.phoneNum);c.item.vcodeBox.hide();c._validate.addIgnoreList(["vcode"])}else{c.item.vcodeBox.show()}c.item.codeInput.keyup(function(){c.checkSendStatus()});c.item.msgBtn.click(function(){if(b(this).hasClass("getcode-dis")){return}c.sendMsgCode()});c.item.refresh.click(function(){c.refreshCodeImg()});c.ajaxStatus=true;c.item.subBtn.click(function(){if(!c.ajaxStatus){return}c.doApply()});b(window).on("scroll resize",function(){c.checkVisible()});b(".remark-item textarea").on({"propertychange input":function(){var d=b.trim(b(this).val()).length,e=b(this).siblings(".tips");if(d>=300){e.find(".err-tip").show();e.find(".red-text").html(d)}else{e.find(".err-tip").hide();e.find(".red-text").html(d)}}});if(c.op.phoneNum){b('[name="phone"]').on("input",function(){var d=b('[name="phone"]').val();if(d==c.op.phoneNum){c.item.vcodeBox.hide()}else{c.item.vcodeBox.show()}})}},initValidate:function(){var c=this;var d=new ajk.Roller({boxId:"sel-decorate",zcord:5,title:"装修",trigger:"click",onchange:function(e){c.item.roomDecorateInput.val(e);c.item.roomDecorateInput.trigger("blur")}});c._validate=new ajk.Validate(b("#entrust-form"),{rules:{floorGroup:[{rule:function(h,e,k){var g=true;var f=b('[name="allfloor"]').val();var j=b('[name="myfloor"]').val();if(j&&f){g=j-0<=f-0}k(g)},msg:"楼层不能大于总楼层"}],myfloor:[{rule:function(f,e,g){g(f!=0)},msg:"请填写正确楼层"}],building:[{rule:function(j,e,k){var g=true;var f=b('[name="building"]').val();var h=/^[a-zA-Z0-9\u4E00-\u9FA5]{1,10}$/;if(f){g=h.test(f)}k(g)},msg:"请填写正确楼栋号"}],nickname:[{rule:function(g,e,h){var f=true;var g=b.trim(g);if(g.length>5){f=false}h(f)},msg:"称呼不过5个字"}],unit:[{rule:function(j,e,k){var f=true;var h=b('[name="unit"]').val();var g=/^[a-zA-Z0-9\u4E00-\u9FA5]{1,10}$/;if(h){f=g.test(h)}k(f)},msg:"请填写正确单元号"}],phone:[{rule:function(h,e,j){c.item.codeBox.hide();c._validate.addIgnoreList(["code"]);var f=false,g="";b.ajax({type:"post",url:c.op.ajaxPhoneCheck,data:{user_mobile:c.item.phoneInput.val(),user_id:c.op.userId},dataType:"jsonp",success:function(k){g=k.message;if(k.status==200||k.status==402){f=true}else{f=false}j(f,g)}})},msg:function(e,f){return f}}]}});c._validate.initRules();c._validate.addIgnoreList(["code"]);c._validate.on("error",function(){var e=typeof arguments[0].dom=="string"?arguments[0].dom:arguments[0].dom.attr("name");var f=arguments[0].dom;if((e=="room_decorate")&&arguments[0].status=="error"){f.parents(".sel-box").find(".exia-box").addClass("err-box");f.parents("li").find(".icon-ok").css("display","none")}else{if(e=="floorGroup"){b('input[name="myfloor"],input[name="allfloor"]').addClass("ui-form-input-error");b('input[name="myfloor"]').parents("li").find(".icon-ok").css("display","none")}else{if(e=="xq_id"){b('input[name="xq_id"]').parents("li").find(".icon-ok").css("display","none");setTimeout(function(){b('input[name="xq_name"]').css("border-color","")})}else{if(e=="xq_name"){b('input[name="xq_id"]').trigger("blur")}else{f.parent("li").find(".icon-ok").css("display","none")}}}}});c._validate.on("success",function(){var e=typeof arguments[0].dom=="string"?arguments[0].dom:arguments[0].dom.attr("name");var f=arguments[0].dom;if((e=="room_decorate")){f.parents(".sel-box").find(".exia-box").removeClass("err-box");if(c.getVal("room_decorate")){b('input[name="room_decorate"]').parents("li").find(".icon-ok").css("display","inline-block")}}else{if((e=="myfloor"||e=="allfloor"||e=="floorGroup")){if(c.getVal("myfloor")&&c.getVal("allfloor")){b('input[name="myfloor"],input[name="allfloor"]').removeClass("ui-form-input-error");b('input[name="myfloor"]').parents("li").find(".icon-ok").css("display","inline-block")}}else{if((e=="hx-room"||e=="hx-hall"||e=="hx-toilet")){if(c.getVal("hx-room")&&c.getVal("hx-hall")&&c.getVal("hx-toilet")){f.parents("li").find(".icon-ok").css("display","inline-block")}}else{if(e=="building"||e=="room"){if(c.getVal("building")&&c.getVal("room")){f.parents("li").find(".icon-ok").css("display","inline-block")}}else{if(e=="xq_id"||e=="xq_name"){if(e==="xq_name"){b('input[name="xq_id"]').trigger("blur")}if(c.getVal("xq_name")&&c.getVal("xq_id")){f.parents("li").find(".icon-ok").css("display","inline-block")}}else{f.parent("li").find(".icon-ok").css("display","inline-block")}}}}}})},searchXq:function(){var c=this;var d=new ajk.Autocomplete(b(c.item.xqNameInput),{hasCache:false,insertDom:b(c.item.xqNameInput).parent(),template:_.template(b("#searchxq-tpl").html()),dataSource:function(f,e){b.ajax({url:c.op.autoCompleteApi,type:"GET",dataType:"jsonp",data:{q:f,city_id:c.op.cityId,limit:c.op.limit}}).done(function(g){e(g);c.item.xqAddress.hide()})}});d.on("inputed",function(e){if(!_.isEmpty(e)&&c.item.xqIdInput.val()!=""){c.item.xqNameInput.siblings(".icon-ok").show()}if(c.hasCashedTrueVal!=c.item.xqNameInput.val()){c.item.xqIdInput.val("");c.item.xqAddrInput.val("")}else{c.item.xqIdInput.val(c.hasCashedId)}});d.on("onfocus",function(){return false});d.el.on("blur",function(){d.hide();var f=c.item.xqNameInput.val();var e=c.item.xqIdInput.val();if(f==""){c.item.xqNameInput.siblings(".icon-ok").hide()}else{if(d.dataCenter.length>0&&d.dataCenter[0].commname==f){b(".searchxq-ul li").eq(0).trigger("click")}else{if(!c.item.xqAddrInput.val()){c.item.xqAddress.hide()}}}if(e==""&&f!=""){c.item.xqNameInput.siblings(".icon-ok").hide();c.item.xqNameInput.addClass("ui-form-input-error");c.item.xqNameInput.parent("li").find(".com-msg").show().html('<i class="icon ico-hint"></i>没有匹配的小区，不能发布房源')}return false});d.on("empty",function(){this.hide();c.item.xqNameInput.siblings(".icon-ok").hide()});d.on("selected",function(e){if(e.data){c.hasCashedTrueVal=c.item.xqNameInput.val();c.hasCashedId=e.data.id;c.item.xqIdInput.val(e.data.id);c.item.xqAddrInput.val(e.data.address);c.item.xqNameInput.siblings(".com-msg").hide();c.item.xqAddress.show().text(e.data.name+"-"+e.data.address)}})},doApply:function(){var c=this;if(b(".upload-box").length==0){c.item.housePicInput.val("")}c._validate.checkAll(function(d){if(!d){return}var e=c.item.landlordNote.val(),f=[];var g;b(".upload-box").each(function(){var j={};var k=b(this).find(".ipv").val();var h=JSON.parse(k);j.image_id=h.id;j.host_id=h.host;f.push(j)});g=JSON.stringify(f);c.ajaxStatus=false;b.ajax({url:c.op.ajaxUrl,type:"get",dataType:"json",data:{city_id:c.op.cityId,user_id:c.op.userId,community_id:c.getVal("xq_id"),user_name:c.getVal("nickname"),total_price:c.getVal("price"),room_num:c.getVal("hx-room"),hall_num:c.getVal("hx-hall"),toilet_num:c.getVal("hx-toilet"),floor:c.getVal("myfloor"),floor_num:c.getVal("allfloor"),area_num:c.getVal("area"),building_num:c.getVal("building"),unit_num:c.getVal("unit"),fitment_id:c.getVal("room_decorate"),user_mobile:c.getVal("phone"),owner_mind:e,images:g},success:function(l){c.ajaxStatus=true;if(l.code===200){var j=new SiteTracker("anjuke-npv");j.setCustomParam("{pc_wtfffld_wt}");j.track();c.item.formBox.hide();b(window).scrollTop(0);c.item.successBox.find(".contact-tip").find("em").text(c.getVal("phone"));c.item.successBox.show()}else{if(l.code==404){var k=c.item.landlordNote.siblings(".tips");k.find(".err-tip").show();k.find(".err-tip em").html(l.msg||"您的业主说内容涉及敏感词汇，请修改后提交")}else{if(l.code==405){var h=b(".contact-item");h.find(".icon-ok").hide();var m=l.msg||"您的称呼涉及敏感词汇，请修改后提交";h.find(".com-msg").html('<i class="icon ico-hint"></i>'+m);h.show()}else{c.showErr("phone",l.msg)}}}},error:function(){c.ajaxStatus=true}})})},sendMsgCode:function(e){var d=this;var c={};c.biz_id=113;c.user_mobile=d.getVal("phone");if(!b(".code-item").is(":hidden")){c.captcha=d.getVal("code")}d._validate.checkAsList(["phone"],function(f){if(!f){return}if(d.isSend){d.isSend=false;b.ajax({url:d.op.hostName+"/v3/ajax/buildphonemessage/",type:"post",dataType:"jsonp",data:c,success:function(g){if(g.status==200){d.verfiyCountdown(d.item.msgBtn,60)}else{d.isSend=true;if(g.status==401){d.showErr("phone",g.message)}else{if(g.status==407){d.item.codeBox.show();d._validate.removeIgnoreList(["code"])}else{d.showErr("code",g.message)}}}}})}})},getVal:function(c){return b('[name="'+c+'"]').val()},showErr:function(c,e){var d=b('[name="'+c+'"]');d.addClass("ui-form-input-error");d.parent("li").find(".com-msg").show().html('<i class="icon ico-hint"></i>'+e)},checkSendStatus:function(){var d=this,c=d.getVal("phone"),e=d.getVal("code");if(c){if(!b(".code-item").is(":hidden")&&!e){d.item.msgBtn.addClass("getcode-dis")}else{d.item.msgBtn.removeClass("getcode-dis")}}},refreshCodeImg:function(){var e=b.now(),c,d=b(this.item.codeImg);c=d.attr("src").substr(0,d.attr("src").length-13)+e;d.attr("src",c)},verfiyCountdown:function(e,d){var c=this;if(d==0){c.isSend=true;e.removeAttr("disabled");e.removeClass("getcode-dis");e.text("重新获取");d=d}else{e.attr("disabled","disabled");e.addClass("getcode-dis");e.text(d+"秒后重发");d--;setTimeout(function(){c.verfiyCountdown(e,d)},1000)}},checkVisible:function(){var c=b(".con-wrap").height()-500;if(b(window).scrollTop()>c){b(".right-app").hide()}else{b(".right-app").show()}},trackEvents:function(){var c=this;var f=new SiteTracker("anjuke-npv"),g="{PARAM}";var e={xqNameInput:"wtff_ndxq",phoneInput:"wtff_phone",vcodeInput:"wtff_phone_yzm",buildingInput:"wtff_ldmp",unitInput:"wtff_dyh"};b.each(e,function(j,h){var l=c.item[j];if(l[0].type=="text"||l[0].type=="tel"){l.on("blur",function(){if(l.val().length>0){d(h)}})}else{l.on("click",function(){if(!l.hasClass("dis-btn")){d(h)}})}});b("#iOS-download").on("click",function(){d.call(this,"fywt_pc_xziosapp")});b("#android-download").on("click",function(){d.call(this,"fywt_pc_xzazapp")});function d(h){h="{"+h+"}";f.setCustomParam(h);f.track()}}}})(jQuery);