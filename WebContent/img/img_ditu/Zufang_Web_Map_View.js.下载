var APF={log:function(a){}};APF.Namespace={register:function(d){var c=d.split(".");var a=window;for(var b=0;b<c.length;b++){if(typeof a[c[b]]=="undefined"){a[c[b]]=new Object()}a=a[c[b]]}return a}};APF.Utils={getWindowSize:function(){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return{width:b,height:a}},getScroll:function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return{left:b,top:a}},setCookie:function(c,e,a,h,d,g){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var f=new Date(b.getTime()+(a));document.cookie=c+"="+escape(e)+((a)?";expires="+f.toGMTString():"")+((h)?";path="+h:"")+((d)?";domain="+d:"")+((g)?";secure":"")},getCookie:function(a){var f=document.cookie.split(";");var b="";var d="";var e="";var c=false;for(i=0;i<f.length;i++){b=f[i].split("=");d=b[0].replace(/^\s+|\s+$/g,"");if(d==a){c=true;if(b.length>1){e=unescape(b[1].replace(/^\s+|\s+$/g,""))}return e;break}b=null;d=""}if(!c){return null}},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},setScrollTop:function(a){if(document.body){document.body.scrollTop=a;if(document.body.scrollTop==0){if(document.documentElement){document.documentElement.scrollTop=a}}}else{if(document.documentElement){document.documentElement.scrollTop=a}}},getScrollTop:function(){return document.body?document.body.scrollTop||document.documentElement.scrollTop:document.documentElement.scrollTop},gotoScrollTop:function(f,d){var b=APF.Utils.getScrollTop(),h=0,g=0;var d=d||1;var f=f||0;var a=b>f?1:0;(function(){b=APF.Utils.getScrollTop();h=a?b-f:f-b;g=a?b-h/15*d:b+1+h/15*d;APF.Utils.setScrollTop(g);if(h<=0||b==APF.Utils.getScrollTop()){return}setTimeout(arguments.callee,10)})()}};if(typeof JSON!=="object"){JSON={}}(function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(n){return n<10?"0"+n:n}function this_value(){return this.valueOf()}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};Boolean.prototype.toJSON=this_value;Number.prototype.toJSON=this_value;String.prototype.toJSON=this_value}var gap,indent,meta,rep;function quote(string){rx_escapable.lastIndex=0;return rx_escapable.test(string)?'"'+string.replace(rx_escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);rx_dangerous.lastIndex=0;if(rx_dangerous.test(text)){text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());APF.Namespace.register("ajk");(function(a){ajk.inherit=function(){var f=Array.prototype.splice,c=arguments;var b=c[c.length-1];f.apply(c,[-1,1]);var e=function(){for(var g=0;g<c.length;g++){if(c[g]){c[g].apply(this,arguments)}}b.apply(this,arguments)};for(var d=0;d<c.length;d++){if(c[d]){a.extend(e.prototype,c[d].prototype)}}a.extend(e.prototype,b.prototype);return e};ajk.Observer=function(){this.ob={}};ajk.Observer.prototype.on=function(g,f){var e=g.split(" ");var d={};for(var b=0;b<e.length;b++){if(!this.ob[e[b]]){this.ob[e[b]]=[]}var c=this.ob[e[b]].push(f);d[e[b]]=c-1}return d};ajk.Observer.prototype.off=function(b,d){if(d!==undefined&&!a.isArray(d)){d=[d]}for(var c=0;c<this.ob[b].length;c++){if(d===undefined||a.inArray(c,d)>-1){this.ob[b][c]=undefined}}};ajk.Observer.prototype.trigger=function(c,d){var f;if(!this.ob[c]){return f}var b=d||[];for(var e=0;this.ob[c]&&e<this.ob[c].length;e++){if(!this.ob[c][e]){continue}var g=this.ob[c][e].apply(this,b);f=(f===false)?f:g}return f};ajk.Observer.prototype.once=function(c,e){var b=this;var d=b.on(c,function(){e.apply(this,arguments);b.off(c,d[c])})}})(jQuery);APF.Namespace.register("ajk");(function(){var logger;var siteName=(function(){var hostData=document.location.host.match(/^(\w+)\.(\w+)\./);if(hostData){return"pc"}else{return"unknown"}})();var rAf=function(callback){window.setTimeout(callback,1000/10)};ajk.Logger=logger={sojSite:"",sojPage:"",sojPageName:"",errorSite:siteName};logger.setSite=function(site){this.sojSite=site||""};logger.setPage=function(page){this.sojPage=page||""};logger.setPageName=function(pagename){this.sojPageName=pagename||""};logger.setCtid=function(ctid){this.ctid=ctid||""};logger.config={devLogURL:"//s.anjuke.test/ts.html?",logURL:"//m.anjuke.com/ts.html?",devSojURL:"//s.anjuke.test/stb",isDev:/dev|test/.test(document.domain),blackList:["Player","baiduboxapphomepagetag","onTouchMoveInPage"]};logger.isblack=function(str){var self=this;var i,reg,length,blackList=self.config.blackList;if(typeof str!=="string"){return true}for(i=0,length=blackList.length;i<length;i++){reg=new RegExp(blackList[i],"g");if(reg.test(str)){return true}}};logger.sendError=function(params){var self=this;var errorinfo="tp=error&site="+self.errorSite+"&msg=",key,url,arr=[],image,msg;if(typeof params==="string"){msg=params}if(typeof params==="object"){for(key in params){if(params.hasOwnProperty(key)){arr.push(key+":"+encodeURIComponent(JSON.stringify(params[key])))}}msg=arr.join(",")}if(self.isblack(msg)){return false}image=new Image();if(self.config.isDev){url=self.config.devLogURL+errorinfo+msg}else{url=self.config.logURL+errorinfo+msg}image.src=url;return true};var getScreen=function(){var sinfo={};sinfo.w=$(window).width().toString();sinfo.h=$(window).height().toString();sinfo.r=(window.devicePixelRatio&&window.devicePixelRatio>=2?1:0).toString();getScreen=function(){return sinfo};return sinfo};logger.sendSoj=function(op){var self=this;var _site=op.site||self.sojSite,soj=new SiteTracker(),t_params;if(op.customparam){soj.setCustomParam(op.customparam)}if(self.config.isDev){t_params={target_url:self.config.devSojURL}}var _page=op.page||self.sojPage,_ctid=self.ctid;var _pageName=op.pageName||self.sojPageName||_page;soj.setPage(_page);soj.setPageName(_pageName);soj.setSite(_site);soj.setScreen(getScreen());soj.setNCtid(_ctid);soj.setReferer(op.r||document.referrer);if(op.NGuid){soj.setNGuid(op.NGuid)}if(op.NUid){soj.setNUid(op.NUid)}if(op.h){if(!t_params){t_params={}}t_params.h=op.h}soj.track(t_params);try{if(!/npv/.test(_site)){var trackUrl=soj.getParams();delete trackUrl.cp;delete trackUrl.sc;window._trackURL=JSON.stringify(trackUrl);loadTrackjs()}}catch(e){}function loadTrackjs(){var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src="//tracklog.58.com/referrer_anjuke_pc.js?_="+Math.random();var b=document.body;s.onload=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog");soj.setPageName(_pageName+"_tracklog");soj.track(t_params)};s.onerror=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog_error");soj.setPageName(_pageName+"_tracklog_error");soj.track(t_params)};b.appendChild(s)}};logger.track=function(p,cp,pn){if(!pn){pn=p}if($.isPlainObject(cp)){cp=JSON.stringify(cp)}logger.sendSoj({site:"anjuke-npv",page:p,pageName:pn,customparam:cp||""})};logger.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"_soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})};logger.Exposure=function(op){var defaults={site:"",trackTag:"data-trace",delay:50,page:"",pageName:"",NUid:"",NGuid:"",prefix:""};this.ops=$.extend(defaults,op);this.domCache=[];this.pageViewHeight=$(window).height();this.timer=null;this.dataCache=[];this.expStatus=false;this.init()};logger.Exposure.prototype={constructor:logger.Exposure,add:function(list){var _this=this;this.expStatus=true;list.each(function(index,el){_this.domCache.push($(el))})},init:function(){var wd=$(window),self=this;wd.resize($.proxy(this.resize,this));wd.on("beforeunload",$.proxy(this.beforeunload,this));rAf(scroll);function scroll(){rAf(scroll);if(!self.expStatus){return}clearTimeout(self.timer);if(self.domCache.length===0){self.expStatus=false;self.buildData();return}self.timer=setTimeout(function(){$.proxy(self.addData,self)()},self.ops.delay)}},resize:function(){this.pageViewHeight=$(window).height()},beforeunload:function(){this.buildData()},scroll:function(){},sendExp:function(result){logger.sendSoj({NGuid:this.ops.NGuid,NUid:this.ops.NUid,site:this.ops.site,page:this.ops.prefix+this.ops.page,pageName:this.ops.prefix+this.ops.pageName,customparam:result})},addData:function(){var pageViewHeight=this.pageViewHeight,topY=$(window).scrollTop(),botY=topY+pageViewHeight,_this=this;if(this.domCache.length===0){return}$.each(this.domCache,function(index,val){var _topY,attr;if(!val){return}_topY=val.offset?val.offset().top:0;if(_topY>topY&&_topY<botY){attr=val.attr(_this.ops.trackTag);if(attr){_this.dataCache.push(attr)}delete _this.domCache[index]}});this.buildData()},buildData:function(){var _this=this,result={},r=[],exp,key,length,i;if(this.dataCache.length===0){return}exp=eval("(["+this.dataCache.join(",")+"])");this.dataCache=[];for(i=0,length=exp.length;i<length;i++){for(key in exp[i]){if(!result[key]){result[key]=[]}result[key].push(exp[i][key])}}for(key in result){r.push('"'+key+'":['+result[key].join(",")+"]")}this.sendExp('{"exposure":{'+r.join(",")+"}}");$.each(this.domCache,function(index,val){if(!val){_this.domCache.splice(index,1)}})}};window.onerror=function(msg,url,line){logger.sendError({message:msg,url:url,line:line})};$(function(){logger.addLinkSoj("a[_soj]");if(window.top!==window){$("#trunk").hide()}})})();APF.Namespace.register("ajk");(function(){var a;ajk.DropDown=a=ajk.inherit(ajk.Observer,function(d,c,e){var b=this;b._op=$.extend({},{timer:500},e||{});b._target=d;b._list=c;b._timer;b.isOpen=false;b._bindEvent()});a.prototype._bindEvent=function(){var c=this;var b=function(){c._timer=setTimeout(function(){c.close()},c._op.timer)};c._target.on("mouseenter",function(){if(!c.isOpen){c.open()}});c._target.on("mouseleave",function(){if(c.isOpen){b()}});c._list.on("mouseenter",function(){clearTimeout(c._timer)});c._list.on("mouseleave",function(){if(c.isOpen){b()}});c._list.on("click",function(){c.close()})};a.prototype.open=function(){var b=this;if(b.trigger("open",arguments)!==false){b.isOpen=true;b._list.show()}};a.prototype.close=function(){var b=this;if(b.trigger("close",arguments)!==false){b.isOpen=false;b._list.hide()}}})();APF.Namespace.register("ajk");(function(a){ajk.DataCache=function(c){var b=this;b._cache=[];b.source=c};ajk.DataCache.prototype.get=function(l,k){var m=this,g=[],n=[],h=_.isArray(l)?l:[l];var b=function(o,j){if(!_.isArray(l)){k(o[0],j[0])}else{k(o,j)}};for(var e=0;e<h.length;e++){var c=m.find(h[e]);if(c!==null){g[e]=c}else{n.push({id:e,query:h[e]})}}if(n.length===0){b(g,h);return}for(var d=0,f=0;d<n.length;d++){(function(){var j=n[d];m.source(j.query,function(p){var o=m.add(j.query,p).data;g[j.id]=o;f++;if(f===n.length){b(g,h)}})})()}};ajk.DataCache.prototype.add=function(c,e){var b=this,d={key:c,data:e};b._cache.push(d);return d};ajk.DataCache.prototype.find=function(f){var d=this,c=null,e=0,b=d._cache.length;for(;e<b;e++){if(_.isEqual(d._cache[e].key,f)){c=d._cache[e].data;break}}return c}})(jQuery);APF.Namespace.register("ajk");(function(a){ajk.Autocomplete=ajk.inherit(ajk.Observer,function(c,e){var b='<ul class="auto-ul"><% _.each(obj,function(item){ %><li><span><%= item.keyword %></span><b>约<%= item.num %>套</b></li><%});%><ul>',d={dataSource:function(){},debounce:250,hasCache:true,insertDom:a("body"),template:_.template(b),itemSelector:"li",keySelector:"span",cursorClass:"auto-grayback",wrap:".auto-wrap",emptyFetch:false};this.op=a.extend({},d,e);this.op.wrapStyle=a.extend({},d.wrapStyle,e.wrapStyle);this.el=c;this._init()});ajk.Autocomplete.prototype._init=function(){this.wrap=null;this.sourceChecked=null;this.dataCenter=[];this.keyword=null;this._createWrap();this.resetCursored();this._checkSource();this._delay=false;if(this.op.hasCache){this.dataCache=new ajk.DataCache(this.sourceChecked)}this._bindEvent()};ajk.Autocomplete.prototype._createWrap=function(){if(this.op.wrap.constructor==jQuery){this.wrap=this.op.wrap.eq(0)}else{if(_.isString(this.op.wrap)){var c=a.trim(this.op.wrap);var b=c.substring(0,1);if(b=="."){this.wrap=a('<div class="'+c.slice(1)+'"></div>')}else{if(b=="<"){this.wrap=a(c)}}this.wrap.appendTo(this.op.insertDom)}}};ajk.Autocomplete.prototype._bindEvent=function(){this._onKeyup();this._onMouseover();this._onClick();this._onFocus();this._onBlur();this._isEnterWrap();this._onMousedown()};ajk.Autocomplete.prototype._onKeyup=function(){var b=this;b.el.on("keyup",function(c){b._updateKeyword();switch(c.keyCode){case 35:case 36:case 16:case 17:case 18:case 37:case 39:break;case 40:b.cursor(+1,true);break;case 38:b.cursor(-1,true);break;case 13:if(b.cursorIndex!=-1){b.select(b.wrap.find(b.op.itemSelector).eq(b.cursorIndex))}break;default:b._inputCheck(b.keyword);break}})};ajk.Autocomplete.prototype._isEnterWrap=function(){var b=this;b.wrap.on("mouseover",function(){b._delay=true});b.wrap.on("mouseout",function(){b._delay=false})};ajk.Autocomplete.prototype._onMouseover=function(){var b=this;b.wrap.on("mouseover",b.op.itemSelector,function(){b.cursorIndex=_index=a(this).index();b.cursor(_index)})};ajk.Autocomplete.prototype._onClick=function(){var b=this;b.wrap.on("click",b.op.itemSelector,function(){b.select(a(this))})};ajk.Autocomplete.prototype._onFocus=function(){var b=this;b.el.on("focus",function(){b._updateKeyword();b._inputCheck(b.keyword);if(b.trigger("onfocus",arguments)!==false){b.el.css("border-color","#f60")}})};ajk.Autocomplete.prototype._onMousedown=function(){var b=this;b.wrap.on("mousedown",function(c){c.preventDefault();b.cancelBlur=true;if(b.wrap.find(c.target).length>0){delete b.cancelBlur}})};ajk.Autocomplete.prototype._onBlur=function(){var b=this;b.el.on("blur",function(){if(b.cancelBlur){delete b.cancelBlur;return}if(b.trigger("onblur",arguments)!==false){b.el.css("border-color","#ccc");if(b._delay){setTimeout(function(){b.hide()},150)}else{b.hide()}}})};ajk.Autocomplete.prototype._updateKeyword=function(b){this.keyword=b||this.el.val()};ajk.Autocomplete.prototype._inputCheck=function(b){if(a.trim(b)===""){this.trigger("empty");if(this.op.emptyFetch){this.input(b)}}else{this.input(b)}};ajk.Autocomplete.prototype._checkSource=function(){var b=this;if(a.isFunction(b.op.dataSource)){b.sourceChecked=_.debounce(b.op.dataSource,b.op.debounce)}else{if(a.isArray(b.op.dataSource)){b.sourceChecked=b.op.dataSource}}};ajk.Autocomplete.prototype._updateData=function(){var c=this;if(a.isFunction(c.sourceChecked)){if(c.op.hasCache){c.dataCache.get(c.keyword,b)}else{c.sourceChecked(c.keyword,b)}}else{if(a.isArray(c.sourceChecked)){c.dataCenter=c.sourceChecked;c._render()}}function b(d){c.dataCenter=d;c._render()}};ajk.Autocomplete.prototype._render=function(){this.wrap.html(this.op.template(this.dataCenter));this.resetCursored();if(this.wrap.find(this.op.itemSelector).length>0){this.show()}else{this.hide()}};ajk.Autocomplete.prototype.show=function(){this.wrap.show()};ajk.Autocomplete.prototype.hide=function(){this.wrap.hide()};ajk.Autocomplete.prototype.resetCursored=function(){this.cursorIndex=-1;this.wrap.find(this.op.itemSelector).removeClass(this.op.cursorClass)};ajk.Autocomplete.prototype.cursor=function(f,e){var c=this,j,b,d={},h=arguments[1]===undefined?false:arguments[1],g=c.wrap.find(c.op.itemSelector);if(!h){j=f}else{j=c.cursorIndex+f;if(j>g.length-1){j=0}else{if(j<0){j=g.length-1}}}b=g.eq(j);d={index:j,item:b,data:c.dataCenter[j]};c.cursorIndex=j;if(c.trigger("cursored",[d])!==false){g.removeClass(c.op.cursorClass);b.addClass(c.op.cursorClass)}};ajk.Autocomplete.prototype.select=function(e){var d=this,g=e.index(),f={index:g,item:e,data:d.dataCenter[g]};var c=this.trigger("beforeSelected",[f]);var b=e.find(d.op.keySelector).text();d.el.val(c||b);if(this.trigger("selected",[f])!==false){d.hide()}};ajk.Autocomplete.prototype.input=function(b){if(this.trigger("inputed",arguments)!==false){self.keyword=b;this._updateData()}}})(jQuery);APF.Namespace.register("ajk.UserLogin");(function(){var a;ajk.UserLogin=a=ajk.inherit(ajk.Observer,function(c){var b=this;b._op=$.extend({},{userbox:"#userbox"},c||{});b._userDate=null;b._init()});a.prototype._init=function(){var b=this;b.userbox=$(b._op.userbox);if(APF.Utils.getCookie("aQQ_ajkauthinfos")){b._op.getUserInfo({},function(c){if(c.code===0){b._userDate=c.data;b.updateUserInfo()}b._bindEvent()})}else{b._bindEvent()}};a.prototype._bindEvent=function(){var b=this;if(!b.isLogin()){new ajk.DropDown($(".brokerlogin>.link"),$(".brokerlogin>ul"))}new ajk.DropDown($(".userlogin>.link"),$(".userlogin>ul"))};a.prototype.updateUserInfo=function(){var b=this;if(!b.isLogin()){return}var c=b.getUserHtml();b.userbox.html(c)};a.prototype.isLogin=function(){return this._userDate&&this._userDate.user_id};a.prototype.getUserHtml=function(){var c=this._userDate;var k=c.menu_list;var b="";for(var f=0,d=k.length;f<d;f++){var h=k[f];for(var e=0,l=h.length;e<l;e++){b=b+'<li><a href="'+h[e].url+'">'+h[e].name+"</a></li>"}if(f<d-1){b=b+'<li class="hr"></li>'}}var g='<div class="userlogin userblock userblockfirst"><i class="icon icon-people"></i><a class="link" href="'+c.entry_url+'" rel="nofollow" title="'+c.user_name+'">'+c.user_name+'</a><i class="triangle-down"></i><ul>'+b+"</ul></div>";return g}})();(function(a){a(function(){var b=function(c){var e=c;var d=setTimeout(function(){e.hide()},500);e.data("hiddenTimer",d)};a("#footer").on("click","[data-target]",function(d){d.preventDefault();var c=a(this).data("target");a("#"+c).toggle()});a("#footer").on("mouseout","[data-target]",function(){var c=a(this).data("target");b(a("#"+c))});a("#loan_link, #other_city, #map_link, #house_link, #seo_qa").hover(function(){var c=a(this).data("hiddenTimer");clearTimeout(c)},function(){b(a(this))})})})(jQuery);APF.Namespace.register("ajk.pc");(function($){var sideBar;ajk.pc.sideBar=sideBar=function(op){this._op=$.extend({},{sideBarBox:$(".sidebar"),toTop:$(".sidebar-top"),sidebarNav:$(".sidebar-mod a"),minWidth:1280,minTop:400},op||{});this.init()};sideBar.prototype.init=function(){var self=this;self.addLinkSoj("a[data-soj]");self.checkVisible();$(window).on("scroll resize",function(){self.checkVisible()});self._op.toTop.on("click",function(e){self.sendSoj({site:"anjuke-npv",pn:"track_back_top_click"});$("html,body").animate({scrollTop:0},100)});$("#sid_survey").on("click",function(){self.sendSoj({site:"anjuke-npv",pn:"track_survey_click"})})};sideBar.prototype.checkVisible=function(){var self=this,winWidth=$(window).width(),scrollTop=$(window).scrollTop();if(winWidth>self._op.minWidth){self._op.sideBarBox.show();self._op.sideBarBox.stop().animate({right:"0px"},100);self._op.toTop.removeClass("sd-top-sig")}else{self._op.sideBarBox.stop().animate({right:"-40px"},100);self._op.toTop.addClass("sd-top-sig")}if(scrollTop>self._op.minTop){self._op.toTop.show()}else{self._op.toTop.hide()}self.slideNav()};sideBar.prototype.slideNav=function(){var self=this;self._op.sidebarNav.hover(function(){var hoverWidth=$(this).children(".sidebar-nav-hover").hasClass("sidebar-sao")?"130px":"90px";$(this).children(".sidebar-nav-hover").stop().animate({width:hoverWidth},100)},function(){$(this).children(".sidebar-nav-hover").stop().animate({width:"0px"},100)})};sideBar.prototype.sendSoj=function(op){var self=this;if(ajk&&ajk.Logger){ajk.Logger.sendSoj({page:op.pn,site:op.site,pageName:op.pn})}else{if(J&&J.site&&J.site.trackEvent){J.site.trackEvent(op.pn)}}};sideBar.prototype.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"data-soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})}})(jQuery);APF.Namespace.register("ajk");(function(a){var b=ajk.Roller=ajk.inherit(ajk.Observer,function(e){var c='<div class="exia-box" style="height:<%= height %>px"><div class="sol-label"><span data-val="" data-title="<%= title %>" style="height:<%= height %>px"><%= title %></span><i style="top:<%= top %>px" class="icon icon-seldown"></i></div><ul style="width:<%= width %>px;top:<%= height %>px;"></ul></div>';var f='<li style="height:<%= height %>px;line-height:<%= height %>px;" data-val="<%= value %>"><%= desc %></li>';var d='<option value="<%= value %>"><%= desc %></option>';this.op=a.extend({boxId:"selectbox",zcord:1,trigger:"click",title:undefined,onchange:undefined,crTpl:_.template(c),imTpl:_.template(f),slTpl:_.template(d),rrClass:"exia-box",teClass:"exia-light",downClass:"icon-seldown",upClass:"icon-selup",liClass:"li-over",liStClass:"li-static",labelClass:"sol-label",resetValue:undefined,triggerChange:true,onchange:function(){},onLabelClick:function(){}},e);this.effective=true;this.container=a("#"+this.op.boxId);this.originSel=this.container.find("select");this.initial()});b.prototype.initial=function(){this.drawRoller();this.bindEvent();this.press(0,true)};b.prototype.drawRoller=function(){var l=this,d=this.container,h=d.children("select"),k=l.op.rrClass;var j=d.innerHeight()-2;var e=d.innerWidth()-2;var g=Math.ceil((j-7)/2);var c=l.op.crTpl({value:h.val(),title:l.op.title||h.find("option:first").text(),height:j,width:e,top:g});d.append(c);var f="";h.children("option").each(function(m,o){var n=a(o).prop("value"),p=a(o).text();f+=l.op.imTpl({height:j+2,desc:p,value:n})});d.find("."+k+" ul").append(f)};b.prototype.bindEvent=function(){var c=this;var f=this.container;var d=c.op.rrClass;var e=f.find("."+d);e.bind(c.op.trigger,function(g){var h=a(g.srcElement||g.target);if(g.type=="mouseout"||g.type=="mouseleave"&&!e.find("ul").is(":visible")){return}e.find("ul").is(":visible")?f.css("zIndex",c.op.zcord):f.css("zIndex","999");e.find("i").toggleClass(c.op.downClass+" "+c.op.upClass);e.find("ul").toggle();e.toggleClass(c.op.teClass)});f.on("click","."+d+" li",function(g){c.handlePress(a(this))});f.on("click","."+c.op.labelClass+" span",function(){var g=a(this).data("val");c.op.onLabelClick(g)});f.on("mouseover mouseleave","."+d+" li",function(g){a(this).toggleClass(c.op.liClass)});if(c.op.trigger=="click"){a("body").on("click",function(g){var h=a(g.srcElement||g.target);if(!h.parents("#"+c.op.boxId).length&&!h.is("#"+c.op.boxId)&&e.find("ul").is(":visible")){c.shrink()}})}};b.prototype.shrink=function(){var c=this;var f=this.container;var d=c.op.rrClass;var e=f.find("."+d);f.css("zIndex",c.op.zcord);e.children("ul").hide();e.removeClass(c.op.teClass);e.find("i").removeClass(c.op.upClass).addClass(c.op.downClass)};b.prototype.handlePress=function(g,c){var l=this;var d=this.container;var j=l.op.rrClass;var e=d.find("."+j);var k=g,f=k.text(),h=k.attr("data-val");if(l.op.resetValue&&l.op.resetValue==h){f=l.op.title}e.find("."+l.op.labelClass+" span").attr("data-val",h).html(f);k.siblings().removeClass(l.op.liStClass);k.addClass(l.op.liStClass);l.originSel.val(h);if(l.op.triggerChange){l.originSel.change()}!c&&l.op.onchange(h);l.shrink()};b.prototype.press=function(e,h){var c=this;var g=this.container;var d=c.op.rrClass;var f=g.find("."+d);c.handlePress(f.children("ul").find("li:eq("+e+")"),h)};b.prototype.valid=function(c){this.effective=c};b.prototype.val=function(g,h){var d=this,f=this.container,c=d.op.labelClass,e=f.find("."+c);if(g!=undefined){e.next().find("li").each(function(j,k){if(a(k).attr("data-val")==a.trim(g)){d.press(j,h)}});return d}else{return e.children("span").attr("data-val")}};b.prototype.reset=function(c,e){var g="",h="";var f=this.container;var j=f.innerHeight();var l=this.op.labelClass;var k=f.find("."+l);for(var d=0;d<c.length;d++){g+=this.op.imTpl({height:j,value:c[d].value,desc:c[d].desc});h+=this.op.slTpl({value:c[d].value,desc:c[d].desc})}k.children("span").attr("data-title",c[0].desc);k.next().html(g);this.originSel.html(h);this.press(0,e)}})(jQuery);(function(b){APF.Namespace.register("ajk.VideoPlayer");var a=ajk.VideoPlayer=ajk.inherit(ajk.Observer,function(c){this.op=b.extend({videoPath:"http://www.zhangxinxu.com/study/media/cat.mp4",supplied:"webmv, ogv, m4v",size:{width:"100%",height:"350px"},useStateClassSkin:true,autoBlur:false,smoothPlayBar:true,keyEnabled:false,remainingDuration:true,toggleDuration:true},c);this.dom={videoBox:b(this.op.container),videoWin:b(".jp-jplayer"),playBtn:b(".jp-play"),stopBtn:b(".jp-stop"),repeatBtn:b(".jp-repeat"),toggleBtn:b("[toggle]"),volumnMax:b(".jp-volume-max"),volumnBar:b(".jp-volume-bar"),stateDialog:b(".jp-state-dialog"),networkDialog:b(".jp-networkError-dialog"),closeBtn:b(".jp-btn-close"),reloadBtn:b(".jp-btn-reload"),tipsTitle:b(".jp-state-text"),tipsBtn:b(".jp-state-button")},this.state={waiting:undefined,reloadTimes:0,errored:false,stalled:false,finished:false};this.tips={errored:{title:"视频信息获取失败，请刷新重试",btn:"刷新"},stalled:{title:"视频加载中…",btn:false},finished:{title:"视频播放完毕",btn:"重新播放"}};this.init();this.acts()});a.prototype.init=function(){var c=this;c.dom.videoWin.jPlayer({ready:function(){b(this).jPlayer("setMedia",{m4v:c.op.videoPath})},error:function(d){c.handleError(d)},swfPath:c.op.swfPath,supplied:c.op.supplied,size:c.op.size,preload:"none",useStateClassSkin:true,autoBlur:false,smoothPlayBar:true,keyEnabled:false,remainingDuration:true,toggleDuration:true})};a.prototype.acts=function(){var c=this;c.dom.volumnMax.click(function(d){b(this).addClass("active")});c.dom.repeatBtn.click(function(){b(this).toggleClass("active")});c.dom.volumnBar.click(function(){c.dom.volumnMax.removeClass("active")});c.dom.videoWin.on(b.jPlayer.event.waiting,function(d){c.state.stalled=true;c.state.waiting=setTimeout(function(){if(c.state.stalled&&!c.state.errored){c.showTips(c.tips.stalled)}},3000)});c.dom.videoWin.on(b.jPlayer.event.playing,function(d){c.state.finished=false;c.state.errored=false;c.state.stalled=false;clearTimeout(c.state.waiting);c.hideTips()});c.dom.videoWin.on(b.jPlayer.event.ended,function(d){c.state.finished=true;c.showTips(c.tips.finished);if(c.op.sendEndSoj&&c.op.sendEndSoj.length>0){if(ajk&&ajk.Logger&&ajk.Logger.sendSoj){ajk.Logger.sendSoj({page:c.op.sendEndSoj,pageName:c.op.sendEndSoj,site:"anjuke-npv"})}else{if(window.J&&J.site&&J.site.trackEvent){J.site.trackEvent(c.op.sendEndSoj)}}}});c.dom.videoWin.on(b.jPlayer.event.error,function(d){c.state.errored=true;c.showTips(c.tips.errored)});c.dom.closeBtn.click(function(){c.dom.stateDialog.hide()});c.dom.reloadBtn.click(function(){if(c.state.errored){if(++c.state.reloadTimes>=5){location.reload()}else{c.play()}}else{if(c.state.finished){c.hideTips();c.play()}}})};a.prototype.show=function(c){var d=this;c?d.dom.videoBox.show():d.dom.videoBox.hide()};a.prototype.showTips=function(f){var d=this;var e=f.title;var c=f.btn;if(e){d.dom.tipsTitle.html(e)}if(c){d.dom.tipsBtn.show();d.dom.tipsBtn.html(c)}if(c===false){d.dom.tipsBtn.hide()}d.dom.networkDialog.show()};a.prototype.hideTips=function(d,c){this.dom.networkDialog.hide()};a.prototype.play=function(d){var c=this;switch(d){case"play":c.dom.videoWin.jPlayer("play");break;case"stop":c.dom.videoWin.jPlayer("stop");break;case"repeat":c.dom.repeatBtn.trigger("click");break;default:c.dom.videoWin.jPlayer("play")}};a.prototype.resetMedia=function(d){var c=this;c.dom.videoWin.jPlayer("setMedia",{m4v:d})};a.prototype.handleError=function(c){}})(jQuery);var pageName="zf_newmap";var expPage="zf_Map_ViewProp";var expPageName="zf_Anjuke_View_saleProperty";window.sendMapLog=function(a,b){ajk.Logger.sendSoj({page:a||pageName,pageName:a||pageName,site:"anjuke-npv",customparam:JSON.stringify(b)})};window.sendMapPv=function(b,a){ajk.Logger.sendSoj({h:a,r:window.location.href,page:expPage,pageName:expPageName,site:"anjuke",customparam:JSON.stringify(b)})};window.sendSoj=function(c,a,d,b){a?sendMapPv(d,b):sendMapLog(c)};if(!function(){}.bind){Function.prototype.bind=function(c){var a=this,b=Array.prototype.slice.call(arguments);return function(){return a.apply(c,b.slice(1))}}}jQuery.removeHtml=function(a){return(a)?jQuery("<p>").append(a).text():""};function checkBrowser(){var b=navigator.userAgent,a=0,c=/PhantomJS/i;var d;try{null[0]()}catch(f){d=f}if(c.test(b)){return a}if(c.test(d)){return a}if(window.callPhantom||window._phantom){return a}if(window.process&&window.process.type){return a}return 1}APF.Namespace.register("ajk.chart");(function(){var G=[];var w=0;var E="";var K=8;function O(T){return z(y(F(T),T.length*K))}function d(T){return k(y(F(T),T.length*K))}function l(T){return r(y(F(T),T.length*K))}function e(T,U){return z(S(T,U))}function n(T,U){return k(S(T,U))}function v(T,U){return r(S(T,U))}function f(){return O("abc")=="900150983cd24fb0d6963f7d28e17f72"}G.push(["\x6D\x64\x35","\x73\x68\x61\x31","\x73\x68\x61\x32\x35\x36"]);function y(ad,Y){ad[Y>>5]|=128<<((Y)%32);ad[(((Y+64)>>>9)<<4)+14]=Y;var ac=1732584193;var ab=-271733879;var aa=-1732584194;var Z=271733878;for(var V=0;V<ad.length;V+=16){var X=ac;var W=ab;var U=aa;var T=Z;ac=q(ac,ab,aa,Z,ad[V+0],7,-680876936);Z=q(Z,ac,ab,aa,ad[V+1],12,-389564586);aa=q(aa,Z,ac,ab,ad[V+2],17,606105819);ab=q(ab,aa,Z,ac,ad[V+3],22,-1044525330);ac=q(ac,ab,aa,Z,ad[V+4],7,-176418897);Z=q(Z,ac,ab,aa,ad[V+5],12,1200080426);aa=q(aa,Z,ac,ab,ad[V+6],17,-1473231341);ab=q(ab,aa,Z,ac,ad[V+7],22,-45705983);ac=q(ac,ab,aa,Z,ad[V+8],7,1770035416);Z=q(Z,ac,ab,aa,ad[V+9],12,-1958414417);aa=q(aa,Z,ac,ab,ad[V+10],17,-42063);ab=q(ab,aa,Z,ac,ad[V+11],22,-1990404162);ac=q(ac,ab,aa,Z,ad[V+12],7,1804603682);Z=q(Z,ac,ab,aa,ad[V+13],12,-40341101);aa=q(aa,Z,ac,ab,ad[V+14],17,-1502002290);ab=q(ab,aa,Z,ac,ad[V+15],22,1236535329);ac=R(ac,ab,aa,Z,ad[V+1],5,-165796510);Z=R(Z,ac,ab,aa,ad[V+6],9,-1069501632);aa=R(aa,Z,ac,ab,ad[V+11],14,643717713);ab=R(ab,aa,Z,ac,ad[V+0],20,-373897302);ac=R(ac,ab,aa,Z,ad[V+5],5,-701558691);Z=R(Z,ac,ab,aa,ad[V+10],9,38016083);aa=R(aa,Z,ac,ab,ad[V+15],14,-660478335);ab=R(ab,aa,Z,ac,ad[V+4],20,-405537848);ac=R(ac,ab,aa,Z,ad[V+9],5,568446438);Z=R(Z,ac,ab,aa,ad[V+14],9,-1019803690);aa=R(aa,Z,ac,ab,ad[V+3],14,-187363961);ab=R(ab,aa,Z,ac,ad[V+8],20,1163531501);ac=R(ac,ab,aa,Z,ad[V+13],5,-1444681467);Z=R(Z,ac,ab,aa,ad[V+2],9,-51403784);aa=R(aa,Z,ac,ab,ad[V+7],14,1735328473);ab=R(ab,aa,Z,ac,ad[V+12],20,-1926607734);ac=L(ac,ab,aa,Z,ad[V+5],4,-378558);Z=L(Z,ac,ab,aa,ad[V+8],11,-2022574463);aa=L(aa,Z,ac,ab,ad[V+11],16,1839030562);ab=L(ab,aa,Z,ac,ad[V+14],23,-35309556);ac=L(ac,ab,aa,Z,ad[V+1],4,-1530992060);Z=L(Z,ac,ab,aa,ad[V+4],11,1272893353);aa=L(aa,Z,ac,ab,ad[V+7],16,-155497632);ab=L(ab,aa,Z,ac,ad[V+10],23,-1094730640);ac=L(ac,ab,aa,Z,ad[V+13],4,681279174);Z=L(Z,ac,ab,aa,ad[V+0],11,-358537222);aa=L(aa,Z,ac,ab,ad[V+3],16,-722521979);ab=L(ab,aa,Z,ac,ad[V+6],23,76029189);ac=L(ac,ab,aa,Z,ad[V+9],4,-640364487);Z=L(Z,ac,ab,aa,ad[V+12],11,-421815835);aa=L(aa,Z,ac,ab,ad[V+15],16,530742520);ab=L(ab,aa,Z,ac,ad[V+2],23,-995338651);ac=o(ac,ab,aa,Z,ad[V+0],6,-198630844);Z=o(Z,ac,ab,aa,ad[V+7],10,1126891415);aa=o(aa,Z,ac,ab,ad[V+14],15,-1416354905);ab=o(ab,aa,Z,ac,ad[V+5],21,-57434055);ac=o(ac,ab,aa,Z,ad[V+12],6,1700485571);Z=o(Z,ac,ab,aa,ad[V+3],10,-1894986606);aa=o(aa,Z,ac,ab,ad[V+10],15,-1051523);ab=o(ab,aa,Z,ac,ad[V+1],21,-2054922799);ac=o(ac,ab,aa,Z,ad[V+8],6,1873313359);Z=o(Z,ac,ab,aa,ad[V+15],10,-30611744);aa=o(aa,Z,ac,ab,ad[V+6],15,-1560198380);ab=o(ab,aa,Z,ac,ad[V+13],21,1309151649);ac=o(ac,ab,aa,Z,ad[V+4],6,-145523070);Z=o(Z,ac,ab,aa,ad[V+11],10,-1120210379);aa=o(aa,Z,ac,ab,ad[V+2],15,718787259);ab=o(ab,aa,Z,ac,ad[V+9],21,-343485551);ac=t(ac,X);ab=t(ab,W);aa=t(aa,U);Z=t(Z,T)}return Array(ac,ab,aa,Z)}G.push(["\x6D\x64\x35","\x73\x68\x61\x32\x35\x36","\x73\x68\x61\x31"]);function m(Y,V,U,T,X,W){return t(g(t(t(V,Y),t(T,W)),X),U)}function q(V,U,Z,Y,T,X,W){return m((U&Z)|((~U)&Y),V,U,T,X,W)}G.push(["\x73\x68\x61\x31","\x6D\x64\x35","\x73\x68\x61\x32\x35\x36"]);function R(V,U,Z,Y,T,X,W){return m((U&Y)|(Z&(~Y)),V,U,T,X,W)}function L(V,U,Z,Y,T,X,W){return m(U^Z^Y,V,U,T,X,W)}function o(V,U,Z,Y,T,X,W){return m(Z^(U|(~Y)),V,U,T,X,W)}G.push(["\x73\x68\x61\x31","\x73\x68\x61\x32\x35\x36","\x6D\x64\x35"]);function S(V,Y){var X=F(V);if(X.length>16){X=y(X,V.length*K)}var T=Array(16),W=Array(16);for(var U=0;U<16;U++){T[U]=X[U]^909522486;W[U]=X[U]^1549556828}var Z=y(T.concat(F(Y)),512+Y.length*K);return y(W.concat(Z),512+128)}G.push(["\x73\x68\x61\x32\x35\x36","\x6D\x64\x35","\x73\x68\x61\x31"]);function t(T,W){var V=(T&65535)+(W&65535);var U=(T>>16)+(W>>16)+(V>>16);return(U<<16)|(V&65535)}function g(T,U){return(T<<U)|(T>>>(32-U))}G.push(["\x73\x68\x61\x32\x35\x36","\x73\x68\x61\x31","\x6D\x64\x35"]);function F(W){var V=Array();var T=(1<<K)-1;for(var U=0;U<W.length*K;U+=K){V[U>>5]|=(W.charCodeAt(U/K)&T)<<(U%32)}return V}function r(V){var W="";var T=(1<<K)-1;for(var U=0;U<V.length*32;U+=K){W+=String.fromCharCode((V[U>>5]>>>(U%32))&T)}return W}function z(V){var U=w?"0123456789ABCDEF":"0123456789abcdef";var W="";for(var T=0;T<V.length*4;T++){W+=U.charAt((V[T>>2]>>((T%4)*8+4))&15)+U.charAt((V[T>>2]>>((T%4)*8))&15)}return W}G.push(["\x6D\x64\x35","\x73\x68\x61\x31"]);function k(W){var V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var Y="";for(var U=0;U<W.length*4;U+=3){var X=(((W[U>>2]>>8*(U%4))&255)<<16)|(((W[U+1>>2]>>8*((U+1)%4))&255)<<8)|((W[U+2>>2]>>8*((U+2)%4))&255);for(var T=0;T<4;T++){if(U*8+T*6>W.length*32){Y+=E}else{Y+=V.charAt((X>>6*(3-T))&63)}}}return Y}G.push(["\x6D\x64\x35","\x73\x68\x61\x32\x35\x36"]);var w=0;var E="";var K=8;function u(T){return j(p(I(T),T.length*K))}function M(T){return Q(p(I(T),T.length*K))}G.push(["\x73\x68\x61\x31","\x6D\x64\x35"]);function h(T){return b(p(I(T),T.length*K))}function N(T,U){return j(D(T,U))}G.push(["\x73\x68\x61\x31","\x73\x68\x61\x32\x35\x36"]);function A(T,U){return Q(D(T,U))}function P(T,U){return b(D(T,U))}function H(){return u("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function p(ag,aa){ag[aa>>5]|=128<<(24-aa%32);ag[((aa+64>>9)<<4)+15]=aa;var ah=Array(80);var af=1732584193;var ae=-271733879;var ad=-1732584194;var ac=271733878;var ab=-1009589776;for(var X=0;X<ag.length;X+=16){var Z=af;var Y=ae;var W=ad;var V=ac;var T=ab;for(var U=0;U<80;U++){if(U<16){ah[U]=ag[X+U]}else{ah[U]=C(ah[U-3]^ah[U-8]^ah[U-14]^ah[U-16],1)}var ai=t(t(C(af,5),a(U,ae,ad,ac)),t(t(ab,ah[U]),x(U)));ab=ac;ac=ad;ad=C(ae,30);ae=af;af=ai}af=t(af,Z);ae=t(ae,Y);ad=t(ad,W);ac=t(ac,V);ab=t(ab,T)}return Array(af,ae,ad,ac,ab)}function a(U,T,W,V){if(U<20){return(T&W)|((~T)&V)}if(U<40){return T^W^V}if(U<60){return(T&W)|(T&V)|(W&V)}return T^W^V}function x(T){return(T<20)?1518500249:(T<40)?1859775393:(T<60)?-1894007588:-899497514}function D(V,Y){var X=I(V);if(X.length>16){X=p(X,V.length*K)}var T=Array(16),W=Array(16);for(var U=0;U<16;U++){T[U]=X[U]^909522486;W[U]=X[U]^1549556828}var Z=p(T.concat(I(Y)),512+Y.length*K);return p(W.concat(Z),512+160)}function t(T,W){var V=(T&65535)+(W&65535);var U=(T>>16)+(W>>16)+(V>>16);return(U<<16)|(V&65535)}function C(T,U){return(T<<U)|(T>>>(32-U))}G.push(["\x73\x68\x61\x32\x35\x36","\x6D\x64\x35"]);function I(W){var V=Array();var T=(1<<K)-1;for(var U=0;U<W.length*K;U+=K){V[U>>5]|=(W.charCodeAt(U/K)&T)<<(32-K-U%32)}return V}function b(V){var W="";var T=(1<<K)-1;for(var U=0;U<V.length*32;U+=K){W+=String.fromCharCode((V[U>>5]>>>(32-K-U%32))&T)}return W}function j(V){var U=w?"0123456789ABCDEF":"0123456789abcdef";var W="";for(var T=0;T<V.length*4;T++){W+=U.charAt((V[T>>2]>>((3-T%4)*8+4))&15)+U.charAt((V[T>>2]>>((3-T%4)*8))&15)}return W}function Q(W){var V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var Y="";for(var U=0;U<W.length*4;U+=3){var X=(((W[U>>2]>>8*(3-U%4))&255)<<16)|(((W[U+1>>2]>>8*(3-(U+1)%4))&255)<<8)|((W[U+2>>2]>>8*(3-(U+2)%4))&255);for(var T=0;T<4;T++){if(U*8+T*6>W.length*32){Y+=E}else{Y+=V.charAt((X>>6*(3-T))&63)}}}return Y}G.push(["\x73\x68\x61\x32\x35\x36","\x73\x68\x61\x31"]);var c=function c(Y){function ar(au,at){return(au>>>at)|(au<<(32-at))}var am=Math.pow;var ac=am(2,32);var W="length";var ak,aj;var ae="";var ag=[];var V=Y[W]*8;var U=c.h=c.h||[];var ai=c.k=c.k||[];var aa=ai[W];var X={};for(var Z=2;aa<64;Z++){if(!X[Z]){for(ak=0;ak<313;ak+=Z){X[ak]=Z}U[aa]=(am(Z,0.5)*ac)|0;ai[aa++]=(am(Z,1/3)*ac)|0}}Y+="\x80";while(Y[W]%64-56){Y+="\x00"}for(ak=0;ak<Y[W];ak++){aj=Y.charCodeAt(ak);if(aj>>8){return}ag[ak>>2]|=aj<<((3-ak)%4)*8}ag[ag[W]]=((V/ac)|0);ag[ag[W]]=(V);for(aj=0;aj<ag[W];){var af=ag.slice(aj,aj+=16);var T=U;U=U.slice(0,8);for(ak=0;ak<64;ak++){var ah=ak+aj;var ab=af[ak-15],ad=af[ak-2];var ao=U[0],al=U[4];var aq=U[7]+(ar(al,6)^ar(al,11)^ar(al,25))+((al&U[5])^((~al)&U[6]))+ai[ak]+(af[ak]=(ak<16)?af[ak]:(af[ak-16]+(ar(ab,7)^ar(ab,18)^(ab>>>3))+af[ak-7]+(ar(ad,17)^ar(ad,19)^(ad>>>10)))|0);var ap=(ar(ao,2)^ar(ao,13)^ar(ao,22))+((ao&U[1])^(ao&U[2])^(U[1]&U[2]));U=[(aq+ap)|0].concat(U);U[4]=(U[4]+aq)|0}for(ak=0;ak<8;ak++){U[ak]=(U[ak]+T[ak])|0}}for(ak=0;ak<8;ak++){for(aj=3;aj+1;aj--){var an=(U[ak]>>(aj*8))&255;ae+=((an<16)?0:"")+an.toString(16)}}return ae};var B={"\x6D\x64\x35":O,"\x73\x68\x61\x31":u,"\x73\x68\x61\x32\x35\x36":c};ajk.chart.algos=B})();(function(){function d(j){var g,h,f,k;g="";f=j.length;for(h=0;h<f;h++){k=j.charCodeAt(h);if((k>=1)&&(k<=127)){g+=j.charAt(h)}else{if(k>2047){g+=String.fromCharCode(224|((k>>12)&15));g+=String.fromCharCode(128|((k>>6)&63));g+=String.fromCharCode(128|((k>>0)&63))}else{g+=String.fromCharCode(192|((k>>6)&31));g+=String.fromCharCode(128|((k>>0)&63))}}}return g}function b(l){var g,j,f,m;var k,h;g="";f=l.length;j=0;while(j<f){m=l.charCodeAt(j++);switch(m>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:g+=l.charAt(j-1);break;case 12:case 13:k=l.charCodeAt(j++);g+=String.fromCharCode(((m&31)<<6)|(k&63));break;case 14:k=l.charCodeAt(j++);h=l.charCodeAt(j++);g+=String.fromCharCode(((m&15)<<12)|((k&63)<<6)|((h&63)<<0));break}}return g}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var e=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function c(m){var h,k,f;var l,j,g;f=m.length;k=0;h="";while(k<f){l=m.charCodeAt(k++)&255;if(k==f){h+=a.charAt(l>>2);h+=a.charAt((l&3)<<4);h+="==";break}j=m.charCodeAt(k++);if(k==f){h+=a.charAt(l>>2);h+=a.charAt(((l&3)<<4)|((j&240)>>4));h+=a.charAt((j&15)<<2);h+="=";break}g=m.charCodeAt(k++);h+=a.charAt(l>>2);h+=a.charAt(((l&3)<<4)|((j&240)>>4));h+=a.charAt(((j&15)<<2)|((g&192)>>6));h+=a.charAt(g&63)}return h}ajk.chart.algos.base64_encode=c})();function gettoken(b,f){var c=Math.floor(b/2);var a=[["\x6D\x64\x35","\x73\x68\x61\x31","\x73\x68\x61\x32\x35\x36"],["\x6D\x64\x35","\x73\x68\x61\x32\x35\x36","\x73\x68\x61\x31"],["\x73\x68\x61\x31","\x73\x68\x61\x32\x35\x36","\x6D\x64\x35"],["\x73\x68\x61\x31","\x6D\x64\x35","\x73\x68\x61\x32\x35\x36"],["\x73\x68\x61\x32\x35\x36","\x73\x68\x61\x31","\x6D\x64\x35"],["\x73\x68\x61\x32\x35\x36","\x6D\x64\x35","\x73\x68\x61\x31"],["\x6D\x64\x35","\x73\x68\x61\x31"],["\x73\x68\x61\x31","\x6D\x64\x35"],["\x6D\x64\x35","\x73\x68\x61\x32\x35\x36"],["\x73\x68\x61\x32\x35\x36","\x6D\x64\x35"],["\x73\x68\x61\x32\x35\x36","\x73\x68\x61\x31"],["\x73\x68\x61\x31","\x73\x68\x61\x32\x35\x36"],"\u0062\u0061\u0073\u0065\u0036\u0034\u005f\u0065\u006e\u0063\u006f\u0064\u0065"];var e=(parseInt(f.substr(0,3),16)+c)%a.length;var d=a[e];if(!$.isArray(d)){return ajk.chart.algos[d](f)}var g=f;$.each(d,function(h,j){g=ajk.chart.algos[j](g)});return g}(function(a,c,b){c.Search=function(d){this.mediator=d;this.observerEvt=null;this.kw="";this.init()};c.Search.prototype={constructor:c.Search,init:function(){var d=this;a(".map-bmap-wrap").on("click",function(){d.auto.wrap.hide()});this.Searchbar({url:b.pubConfig.suggestUrl,cityId:b.pubConfig.cityId,searchType:b.pubConfig.searchType,submitUrl:"/sale/"})},Searchbar:function(h){var d=this;var g=this.auto=new ajk.Autocomplete(a("#search-esf"),{insertDom:a("#search-esf").parent(),template:_.template(a("#search-tpl").html()),emptyFetch:true,dataSource:function(k,j){a.ajax({url:h.url,type:"GET",dataType:"jsonp",data:{kw:k,city_id:h.cityId,app_id:2,from:2,n:10}}).done(function(n){if(k){var o=a.trim(k),o=o.replace(/[~'!<>@#$%^&*()-+_=:]/g,""),l=new RegExp(o,"g"),p=n.data;for(var m=0;m<p.length;m++){p[m]["keyword"]=p[m]["keyword"].replace(l,'<em class="red">'+o+"</em>")}j(p)}else{j(n.data)}})}});var f=a("#search-close"),e=a("#search-button");g.on("inputed",function(j){if(!_.isEmpty(j)){f.show()}});g.on("empty",function(){f.hide()});f.on("click",function(){g.el.val("");g.wrap.hide();f.hide();b.sendMapLog("zf_map_clearsearch")});e.on("click",function(){d.loadData(a("#search-esf").val());g.wrap.hide();if(a("#search-esf").val().length>0){f.show()}});g.on("onfocus",function(){setTimeout(function(){g.el.css("borderColor","#ccc")},0);b.sendMapLog("zf_map_searchbox_clock")});g.el.on("keydown",function(j){if(g.wrap.is(":visible")&&g.wrap.find(".auto-grayback").length==0){if(j.keyCode==38){g.wrap.find("li").first().addClass(".auto-grayback");return}if(j.keyCode==40){g.wrap.find("li").last().addClass(".auto-grayback");return}}if(g.wrap.is(":visible")&&g.wrap.find(".auto-grayback").length){return}if(g.el.val().length&&j.keyCode==13){e.trigger("click");g.wrap.hide()}});g.on("selected",function(j){var k="";e.trigger("click");switch(j.data.type){case 2:b.sendMapLog("zf_map_hotsearch");break;case 3:b.sendMapLog("zf_map_search_history");break;case 6:b.sendMapLog("zf_map_search_recommend");break}})},loadData:function(g){var f=this;this.kw=g;f.mediator._clearSelects();var e=this.mediator.getAjaxSortParams();var d=this.mediator.getAjaxSelectParams();var h=this.params=a.extend({},e,d,{kw:g,p:1,maxp:99});this.mediator.loadMapData(h,function(k){var m=k.val.match_data.match_type_name;if(m&&m=="community"){var o=f.commuinfo=k.val.community_list;if(o.length<=0){return}if(o[0].lat==""){b.sendMapLog("zf_map_search_recommend_bug")}var j={lat:o[0].lat,lng:o[0].lng};f.mediator.setMapCommunityId(o[0].id);f.mediator.centerAndZoomToPoint(j,"commu",false);f.observerEvt=function(){var p=f.mediator.buildAjaxParams();f.mediator.loadMapData(p,function(q){f.mediator.drawMarks(q)});f.observerEvt=null}}else{if(m&&m=="block"){var l=k.val.match_data;var n=k.val.block_list;if(n.length<=0){return}f.mediator.setMapCommunityId("");f.observerEvt=function(){var p=f.mediator.buildAjaxParams();f.mediator.loadMapData(p,function(q){f.mediator.drawMarks(q)});f.observerEvt=null};f.mediator.centerAndZoomToPoint({lat:n[0].lat,lng:n[0].lng},"commu",false,n[0].name)}else{if(m&&m=="region"){var l=k.val.match_data;var n=k.val.region_list;f.mediator.setMapCommunityId("");if(n.length==1&&l.match_type_id&&(l.match_type_id+"").length>0){f.observerEvt=function(){var p=f.mediator.buildAjaxParams();f.mediator.loadMapData(p,function(q){f.mediator.drawMarks(q)});f.observerEvt=null};f.mediator.centerAndZoomToPoint({lat:n[0].lat,lng:n[0].lng},"block",false,n[0].name)}else{if(n.length>=1){f.mediator.centerAndZoomToPoint(b.pubConfig.cityName||"上海","area",false);f.observerEvt=function(){f.mediator.drawMarks(k);f.observerEvt=null}}else{f.mediator.clearMapMarks("points")}}}else{var n=k.val.region_list;if(n&&n.length>0){f.mediator.centerAndZoomToPoint(b.pubConfig.cityName||"上海","area",false);f.observerEvt=function(){f.mediator.drawMarks(k);f.observerEvt=null}}else{f.mediator.clearMapMarks("points")}}}}});f.mediator.loadPropData(h,function(k){var j=undefined;if(k.val.match_data&&k.val.match_data.match_type_name=="community"){var l=f.commuinfo=k.val.match_data.data;j={showHead:true,info:f.commuinfo}}if(k.val.match_data&&k.val.match_data.data){f.mediator.resetListHeadRoomNumTitle(k.val.match_data.data.name)}if(k.val&&k.val.props){_.each(k.val.props,function(m){m.searchkwword=g})}if(k.val.props.length<=0){k.val.searchNull=true}f.mediator.refreshProps(k,j)});b.sendMapLog("zf_map_search")},getKwVal:function(){return a("#search-esf").val()},clearSearch:function(){a("#search-esf").val("");this.kw="";this.auto.wrap.hide();a("#search-close").hide()}}})(jQuery,APF.Namespace.register("ajk"),window);(function(a,c,b){c.Select=function(d){this.mediator=d;this.selects={};this.moreSelParams={type:[],orient:[],tags:[]};this.init()};c.Select.prototype={constructor:c.Select,init:function(){var d=this;var g="mouseenter mouseleave";this.selects.type=new ajk.Roller({boxId:"sel-type",zcord:2,title:"类型",trigger:g,resetValue:"0",onchange:function(k){if(k=="2"){a(".special-con").show()}else{a(".special-con").hide();a(".special-con").find("i").removeClass("checked");a(".special-con").find("i").html("&#xE212;");d.moreSelParams.tags=_.without(d.moreSelParams.tags,3,4);d._clearMoreFiltersWithSpe()}setTimeout(function(){d.updateSelect()},0);b.sendMapLog("zf_map_filter_renttype")}});this.selects.rooms=new ajk.Roller({boxId:"sel-rooms",zcord:3,title:"房型",trigger:g,resetValue:"0",onchange:function(k){setTimeout(function(){d.updateSelect()},0);b.sendMapLog("zf_map_filter_housetype")}});a("#sel-areablock").on("mouseenter",function(){a(this).find(".arealist-wrap").show();a(".blocklist").hide();a(this).find(".s-label .icon").removeClass("icon-seldown").addClass("icon-selup")}).on("mouseleave",function(){a(this).find(".arealist-wrap").hide();a(this).find(".s-label .icon").removeClass("icon-selup").addClass("icon-seldown")});a(".arealist-item").on("mouseenter",function(){a(".blocklist").hide();var k=a(this).data("id");a(".blocklist").each(function(m,l){if(a(l).data("id")==k){a(l).show()}});a(".arealist-item").removeClass("areahover");a(this).addClass("areahover")});a(".arealist-item").on("mouseleave",function(){a(this).removeClass("areahover")});a(".blocklist").on("mouseenter",function(){var k=a(this).data("id");a(".arealist-item").each(function(m,l){if(a(l).data("id")==k){a(l).addClass("areahover")}})});a(".blocklist").on("mouseleave",function(){a(".blocklist").hide()});a(".blocklist li").on("click",function(){if(a(this).data("val")=="0"){var m=a(this).parent().data("id");var l="";var k="";a(".arealist-item").each(function(o,n){if(a(n).data("id")==m){l=a(n).data("val");k=a(n).find("em").text()}});a("#areaid").data("val",l);a("#areaid").attr("data-val",l);a("#areaid").data("title",k);a("#areaid").data("type","area")}else{var l=a(this).data("val");var k=a(this).text();a("#areaid").data("val",l+"");a("#areaid").attr("data-val",l+"");a("#areaid").data("title",k);a("#areaid").data("type","block")}a(".arealist-wrap").hide();setTimeout(function(){d.updateSelect("change_area")},0)});a(".arealist-item em").on("click",function(){var l=a(this).parent();if(l.data("val")=="0"){var m=l.data("val");a("#areaid").data("val",m+"");a("#areaid").attr("data-val",m+"");a("#areaid").data("title","选择区域");a("#areaid").data("type","city")}else{var m=l.data("val");var k=a(this).text();a("#areaid").data("val",m+"");a("#areaid").attr("data-val",m+"");a("#areaid").data("title",k);a("#areaid").data("type","area")}a(".arealist-wrap").hide();setTimeout(function(){d.updateSelect("change_area")},0)});a("#sel-price").on("mouseenter",function(){a(this).find(".rentprice-list").show();a(this).find(".s-label .icon").removeClass("icon-seldown").addClass("icon-selup")}).on("mouseleave",function(){a(this).find(".rentprice-list").hide();a(this).find(".s-label .icon").removeClass("icon-selup").addClass("icon-seldown")});a(".rentprice-list .p-sel").on("click",function(){if(a(this).data("val")=="0"){var l=a(this).data("val");a("#priceid").data("val",l);a("#priceid").attr("data-val",l);a("#priceid").text("租金");a("#priceid").attr("title","租金")}else{var l=a(this).data("val");var k=a(this).text();a("#priceid").data("val",l);a("#priceid").attr("data-val",l);a("#priceid").text(k);a("#priceid").attr("title",k)}a(".rentprice-list").hide();d.updateSelect();b.sendMapLog("zf_map_filter_price")});var h=a("#p-s"),f=a("#p-e"),e=a(".p-i-y");h.on("focus",function(){e.show()});f.on("focus",function(){e.show()});f.on("keyup",function(){this.value=this.value.replace(/\D/g,"")});h.on("keyup",function(){this.value=this.value.replace(/\D/g,"")});a(".p-i-y").click(function(){j();var k=parseInt(a("#p-s").val(),10);var l=parseInt(a("#p-e").val(),10);a("#priceid").attr("data-val",""+k+"_"+l);a("#priceid").text(""+k+"-"+l+"元");a(".rentprice-list").hide();d.updateSelect();b.sendMapLog("zf_map_filter_price")});function j(){var m=/^([1-9](\d{0,4})?)(\.\d{1})?|(^0(\.\d{1})?$)/;var k=h.val().match(m);var l=f.val().match(m);if(k!=null){h.val(k[0])}else{k=0;h.val("")}if(l!=null){f.val(l[0])}else{l=0;f.val("")}if(k==0&&l==0){h.val("");f.val("");return s==1?true:false}if(Number(k[0])>Number(l[0])&&Number(l[0])>=0){h.val(l[0]);f.val(k[0])}}a("#sel-more").on("mouseenter",function(){a(this).find(".more-filter").show();a(this).find(".s-label .icon").removeClass("icon-seldown").addClass("icon-selup")}).on("mouseleave",function(){a(this).find(".more-filter").hide();a(this).find(".s-label .icon").removeClass("icon-selup").addClass("icon-seldown");d.clearUnConfirmConditions()});a(".item-type").on("click","li",function(){var m=a(this).val();var l=a(this).find("i");if(a(this).find("i").hasClass("checked")){l.html("&#xE212;");a(this).find("i").removeClass("checked")}else{l.html("&#xE211;");a(this).find("i").addClass("checked")}var k=this;setTimeout(function(){d.checkThisItemStatus(a(k))},0)});a(".item-type").on("click","span",function(){if(a(this).hasClass("selected")){return}a(this).addClass("selected");a(this).next().find("li").each(function(m,l){a(l).find("i").removeClass("checked");a(l).find("i").html("&#xE212;")})});a(".confirm-morefilter").click(function(){d.moreSelParams.type=d._setVals(a(".fwlx"));d.moreSelParams.orient=d._setVals(a(".fwcx"));d.moreSelParams.tags=d._setVals(a(".fwbq"));a(".more-filter").find(".s-label .icon").removeClass("icon-selup").addClass("icon-seldown");d.updateSelect();a(".more-filter").hide();b.sendMapLog("zf_map_filter_more")});a(".reset-morefilter").click(function(){a(".item-type li").each(function(m,l){a(this).find("i").removeClass("checked");a(this).find("i").html("&#xE212;")});a(".item-type span").each(function(m,l){a(this).addClass("selected")});d.moreSelParams.type=[];d.moreSelParams.orient=[];d.moreSelParams.tags=[];a("#sel-more").find(".more-filter").hide();a("#sel-more").find(".s-label .icon").removeClass("icon-selup").addClass("icon-seldown");d.updateSelect()});a(".filter-clear").on("click",function(){d.mediator.clearFilter();a(this).hide();b.sendMapLog("zf_map_zero_reset_click")})},_clearMoreFiltersWithSpe:function(){if(this.moreSelParams.type.length==0&&this.moreSelParams.orient==0&&this.moreSelParams.tags==0){a(".sel-more .custom-filter").removeClass("label-sel")}},_setVals:function(e){var d=[];e.find("i").each(function(g,f){if(a(f).hasClass("checked")){d.push(a(f).parent().data("val"))}});return d},clearUnConfirmConditions:function(){this._resetVals(a(".fwlx"),this.moreSelParams.type);this._resetVals(a(".fwcx"),this.moreSelParams.orient);this._resetVals(a(".fwbq"),this.moreSelParams.tags)},_resetVals:function(e,d){if(d.length==0){e.find("i").removeClass("checked");e.find("span").addClass("selected")}else{e.find("span").removeClass("selected");e.find(".fi-t i").removeClass("checked");e.find(".fi-t i").html("&#xE212;");e.find(".fi-t i").each(function(g,f){_.each(d,function(j,h){if(a(f).parent().data("val")+""==j||a(f).parent().attr("data-val")+""==j){a(f).addClass("checked");a(f).html("&#xE211;")}})})}},checkThisItemStatus:function(e){var d=false;e.parent().find("li").each(function(g,f){if(a(f).find("i").hasClass("checked")){d=true;return false}});if(d){e.parent().prev().removeClass("selected")}else{e.parent().prev().addClass("selected")}},updateSelect:function(f){var d=this;d.changeSelectedStatus();if(f==="change_area"){d.selectDist()}else{d.mediator.conditionChange();var e=d.mediator.buildAjaxParams();e.p=1;e.maxp=99;d.mediator.loadPropData(e,function(g){d.mediator.refreshProps(g)});d.mediator.loadMapData(e,function(g){d.mediator.drawMarks(g)})}},selectDist:function(){var h=this;var f="";var g="";var e="";var j=a("#areaid").data("val");f=a("#areaid").data("title");g=a("#areaid").data("type");if(j!="-1"&&j!="0"){var d=j.split("_");e={lat:d[1],lng:d[2]}}else{e=b.pubConfig.cityName||"上海";f=undefined}if(g=="block"){g="commu"}else{if(g=="city"){g="area"}else{g="block"}}h.mediator.setMapCommunityId("");h.mediator.centerAndZoomToPoint(e,g,true,f);h.mediator.resetListHeadRoomNumTitle(f);b.sendMapLog("zf_map_filter_area")},changeSelectedStatus:function(){var e=this.selects.type.val();if(e=="0"){a("#sel-type span").removeClass("label-sel")}else{a("#sel-type span").addClass("label-sel")}var d=this.selects.rooms.val();if(d=="0"){a("#sel-rooms span").removeClass("label-sel")}else{a("#sel-rooms span").addClass("label-sel")}a(".mapHeader-filter").find(".custom-filter").each(function(f){if(a(this).data("val")+""==="0"){a(this).removeClass("label-sel")}else{a(this).addClass("label-sel")}});if(a(".item-type li").find("i").hasClass("checked")){a(".sel-more .custom-filter").addClass("label-sel")}else{a(".sel-more .custom-filter").removeClass("label-sel")}},getAllSelectVals:function(){var h=0;var e=0;var g=a("#priceid").attr("data-val");if((g+"").indexOf("_")>=0){var f=g.split("_");h=f[0];e=f[1];g=0}return{room_num:this.selects.rooms.val(),price_id:g,rent_type:this.selects.type.val(),price_min:parseInt(h),price_max:parseInt(e),lx_id:this.moreSelParams.type.join(","),tag_id:this.moreSelParams.tags.join(","),orient_id:this.moreSelParams.orient.join(",")}},resetSelects:function(){var d=this;_.each(this.selects,function(f,e){f.val("0",true)});a(".custom-filter").data("val",0);a(".custom-filter").attr("data-val",0);a("#areaid").data("title","选择区域");a("#priceid").text("租金");this.moreSelParams={type:[],orient:[],tags:[]};a(".more-filter").find("i").html("&#xE212;");a(".more-filter").find("i").removeClass("checked");this.changeSelectedStatus();this.mediator.conditionChange()}}})(jQuery,APF.Namespace.register("ajk"),window);(function(a,c,b){c.List=function(d){this.mediator=d;this.p=1;this.maxp=99;this.loadingPage=false;this.resTxt="地图内";this.noResTxt="重置地图";this.curProp="";this.ifInitedSlick=false;this.init();this.mapping={"床":"&#xE215;","冰箱":"&#xE213;","电视":"&#xE216;","可做饭":"&#xE217;","空调":"&#xE218;","热水器":"&#xE220;","沙发":"&#xE221;","独立卫生间":"&#xE223;","阳台":"&#xE225;","宽带":"&#xE228;","衣柜":"&#xE226;","洗衣机":"&#xE224;","暖气":"&#xE229;"}};c.List.prototype={constructor:c.List,init:function(){this.bindEvts()},bindEvts:function(){var d=this;a(".map-open-arrow").on("click",function(){if(a(".housing-list-wrap").css("display")=="none"){a(".housing-list-wrap").show();a(this).find("i").html("&#xE222;");b.sendMapLog("zf_map_list_unfold")}else{a(".housing-list-wrap").hide();a(this).find("i").html("&#xE227;");b.sendMapLog("zf_map_list_fold")}});a(".list-content-wrap").on("click",".item-mod",function(){var k=a(this),h=k.data("propid"),g=k.data("is_auction"),e=k.data("is_list"),f=a(".housing-list-wrap .item-mod");source_type=k.data("sourcetype");f.removeClass("static");f.removeClass("item-active");k.addClass("item-active");if(d.curProp==h){a(".housing-page-container").toggle();a(".bmap-cover").toggle();if(!k.hasClass("static")){k.addClass("static")}return}var j={prop_id:h,source_type:source_type};if(g=="1"){j.hfilter="filterlist"}d.mediator.getProps(j,function(l){l.val.mapping=d.mapping;d.propDataHandle(l,h);if(l.val.soj_data.cp){b.sendMapPv(l.val.soj_data.cp,l.val.item_more_detail_url)}else{b.sendMapPv({},l.val.item_more_detail_url)}});b.sendMapLog("zf_map_fy_click")});a(".list-content-wrap").on("mouseenter",function(){var e=a(window).height()-a(this).offset().top;a(this).css("height",e+"px");a(this).addClass("wrap-scroll")}).on("mouseleave",function(){a(this).removeClass("wrap-scroll")});a(".list-content-wrap").on("scroll",function(){var e=a(this);var f=e.scrollTop();if(Math.ceil(e.height()+f)>=e[0].scrollHeight){if(d.p<d.maxp){d.p=d.p+1;var g=d.mediator.buildAjaxParams();if(d.loadingPage){return}d.loadingPage=true;if(a(this).find(".item-mod").attr("searchkwword")&&a(this).find(".item-mod").attr("searchkwword").length>0){g.kw=a(this).find(".item-mod").attr("searchkwword")}d.mediator.loadPropData(g,function(h){if(h.val&&h.val.props&&g.kw&&g.kw.length>0){_.each(h.val.props,function(j){j.searchkwword=g.kw})}d.concatProps(h);d.loadingPage=false});b.sendMapLog("zf_map_load_30more")}}});a(".list-content-wrap").on("mouseenter",".item-mod",function(){a(this).addClass("active");d.propOver(a(this),"in")}).on("mouseleave",".item-mod",function(){a(this).removeClass("active");d.propOver(a(this),"out")});a("#list-gotop").on("click",function(){d.gotop()});a("#resetMap").on("click",function(){d.mediator.resetAll();if(a(this).text()=="清除搜索条件"){b.sendMapLog("zf_map_search_zero_clear_click")}else{b.sendMapLog("zf_map_zero_reset_click")}});a("#close_commu").on("click",function(){d.mediator.setMapCommunityId("");d.mediator.closeCommu();b.sendMapLog("zf_map_list_page_close")});a(".cls-page").on("click",function(){a(".housing-list-wrap .item-mod").removeClass("item-active");a(".housing-page-container").hide();a(".bmap-cover").hide();b.sendMapLog("zf_map_fy_page_close")});a(".housing-page-container").on("click",".getnext",function(){d.nextPage();b.sendMapLog("zf_map_fy_page_next")});a(".housing-page-container").on("mouseout mouseover",".phone-wrp",function(h){var j=a(this);var f=j.data("status");if(f==1){return}var g="phone-wrp-hover";if(event.type=="mouseover"){j.addClass(g);return}j.removeClass(g)});a(".housing-page-container").on("click",".phone-wrp",function(g){var h=a(this);var f=h.data("status");if(f==1){return}h.data("status",1);h.removeClass("phone-wrp-hover");h.find("span").html("号码获取中...");a.ajax({url:"/v3/ajax/getBrokerPhone/",dataType:"json",data:{broker_id:h.data("id"),token:h.data("token")},success:function(e){if(e&&e.code==0){h.find("span").html(e.val);return}h.find("span").html("点击查看电话");h.data("status","");alert("行为异常，暂不可查看手机号")},error:function(){h.find("span").html("点击查看电话");h.data("status","");alert("获取手机号失败")}})});a(".zk-more")&&a(".housing-page-wrap").on("click",".zk-more",function(){a(".zk-more").remove();a(".pt-wrp").css("height","auto")})},propOver:function(e,d){this.mediator.traceAnces(e,d)},propDataHandle:function(e,g){var d=this;var f=_.template(a("#prop-tpl").html())(e.val);a(".housing-page-wrap").html(f);d.curProp=g;a(".housing-page-container").show();a(".bmap-cover").show();d.initSlick();a(".housing-page-wrap").scrollTop(0)},initSlick:function(){a(".photoSlide").removeClass("slick-initialized slick-slider");a(".photoSlide").slick({lazyload:"ondemand",fade:true,prevArrow:'<div class="prev-wrap"><i class="iconfont ii-prev">&#xE123;</i></div>',nextArrow:'<div class="next-wrap"><i class="iconfont ii-next">&#xE124;</i></div>'});a(".photoSlide").on("afterChange",function(e,d,g,f){a("#i-sy").text(g+1)})},gotop:function(){a(".list-content-wrap").scrollTop(0)},concatProps:function(e){var d=e.val;if(d.props.length>0){var f=new Date().getTime();_.each(d.props,function(h,g){d.props[g].timestamp=f+""});a("#j-house-list").append(a(_.template(a("#list-tpl").html())(d.props)));ajk.exposure.add(a(".item-expose"+f))}if(d.pages){this.p=d.pages.page||1}this.showLastPage(d)},refreshProps:function(e,f){var d=e.val;this.showPropsNUmInfo(d,f);if(d.pages){this.p=d.pages.page||1}this.showLastPage(d);if(d.props.length<=0){this.noResults(d);b.sendMapLog("zf_map_zero_expose")}if(d.props.length>0){this.hasResults();a("#commu_intro").text(this.resTxt.moreRes);var g=new Date().getTime();_.each(d.props,function(j,h){d.props[h].timestamp=g+""});a("#j-house-list").html(_.template(a("#list-tpl").html())(d.props));a("#j-house-list").show();ajk.exposure.add(a(".item-expose"+g))}this.gotop();if(a(".housing-page-container").css("display")=="block"){a(".cls-page").trigger("click")}if(f){if(!f.info){return}this.showHeaderCommuInfo(f)}else{this.hideHeaderCommuInfo()}},showLastPage:function(d){if(d.pages&&d.pages.total){this.maxp=Math.ceil(d.pages.total/d.pages.page_size)}else{this.maxp=0}if(this.p>=this.maxp){a("#last-tip").show()}},showPropsNUmInfo:function(e,f){var d=0;if(e.pages){d=e.pages.total}if(f&&f.info){a(".resinfo-head .a-name").text("本小区");a(".resinfo-head .num-name").text(d)}else{a(".resinfo-head .a-name").text(this.resTxt);a(".resinfo-head .num-name").text(d);this.resTxt="地图内"}},resetListHeadRoomNumTitle:function(d){this.resTxt=d},noResults:function(d){if(d.searchNull){a("#resetMap").text("清除搜索条件")}else{a("#resetMap").text("重置地图")}a(".list-content-wrap").hide();a(".no-prop-commu").show()},hasResults:function(){a(".list-content-wrap").show();a(".no-prop-commu").hide()},showHeaderCommuInfo:function(d){if(d.info.build_date&&d.info.build_date.length>0){a(".commu-detail-line").show()}else{a(".commu-detail-line").hide()}a(".commu-detail-line").find("em").text(d.info.build_date);a(".commu-name-block a").text(d.info.name);a(".commu-name-block a").attr("href",b.pubConfig.fy_page_pre+d.info.id);a("#commu_detail").show()},hideHeaderCommuInfo:function(){a("#commu_detail").hide();a("#commu_intro").show()},nextPage:function(){var f=this.curProp,e=a(".housing-list-wrap .item-mod"),d=-1;e.each(function(h,g){if(a(g).attr("propid")==f){d=h}});if(d!=-1&&e[d+1]){a(e[d+1]).click()}},hightFangItem:function(d){a(".list-content-wrap .item-mod").each(function(e,f){if(a(f).data("commuid")==d){a(f).addClass("active")}})},blurFangItem:function(d){a(".list-content-wrap .item-mod").each(function(e,f){if(a(f).data("commuid")==d){a(f).removeClass("active")}})}}})(jQuery,APF.Namespace.register("ajk"),window);(function(a,c,b){c.Sort=function(d){this.mediator=d;this.order_id=0;this.init()};c.Sort.prototype={constructor:c.Sort,init:function(){this.bindEvts()},bindEvts:function(){var d=this;a("#sortbar_wrap").on("click","li",function(){var e=a(this).data("tag");switch(e){case"default":a(this).attr("class","cur");if(d.order_id==0){return}d.order_id=0;a(this).siblings("li").find("i").attr("class","icon-map1 i-up-dark");b.sendMapLog("zf_map_list_rank_default");break;case"price":a(this).prev().attr("class","");if(a(this).find("i").hasClass("i-up-light")){d.order_id=1;a(this).find("i").attr("class","icon-map1 i-down-light")}else{d.order_id=2;a(this).find("i").attr("class","icon-map1 i-up-light")}b.sendMapLog("zf_map_list_rank_price");break}var f=d.mediator.buildAjaxParams();f.p=1;f.maxp=99;if(a(".list-content-wrap").find(".item-mod").attr("searchkwword")&&a(".list-content-wrap").find(".item-mod").attr("searchkwword").length>0){f.kw=a(".list-content-wrap").find(".item-mod").attr("searchkwword")}d.mediator.loadPropData(f,function(g){if(g.val&&g.val.props&&f.kw&&f.kw.length>0){_.each(g.val.props,function(h){h.searchkwword=f.kw})}d.mediator.refreshProps(g,{showHead:true})})})}}})(jQuery,APF.Namespace.register("ajk"),window);(function(d,g,f){var c=g.Map=function(h,j){this.mediator=h;this.zoomcf=e(f.pubConfig.zoomCommonConfig);this.op={originZoom:12,minZoom:11,maxZoom:19,cityZ:12,areaZ:12,blockZ:this.zoomcf.block,commuZ:this.zoomcf.commu,ogCommuZ:this.zoomcf.commu,rgName:"",curCenter:{},curCommu:0,visited:[],areaList:{},nowId:""};this.item={mapBox:d(".bmap-container"),zoomIn:d(".scale-wrap .zoomIn"),zoomOut:d(".scale-wrap .zoomOut")};this.BMap=new BMap.Map("bmap-container",{minZoom:this.op.minZoom,maxZoom:this.op.maxZoom,enableMapClick:false});this.community_id="";this.autoLoadMap=true;this.startDragGPtype="";this.centerPoint={lat:"",lng:"",title:""};this.params=j;this.startDragPoint=null;this.init()};c.prototype.init=function(){this.BMap.enableScrollWheelZoom();this.op.areaList=window.groups;this.tilesloaded=this.tilesloaded.bind(this);this.zoomstart=this.zoomstart.bind(this);this.zoomend=this.zoomend.bind(this);this.dragstart=this.dragstart.bind(this);this.dragend=this.dragend.bind(this);this.overlayClick=this.overlayClick.bind(this);this.traceAnces=this.traceAnces.bind(this);this.centerAndZoomLoad=this.centerAndZoomLoad.bind(this);this.bindEvent();if(this.params.community_id>0||(+this.params.paramlng>0&&+this.params.paramlat>0)){var h=new BMap.Point(this.params.paramlng,this.params.paramlat);this.BMap.centerAndZoom(h,this.params.paramzoom)}else{this.centerAndZoom(window.pubConfig.cityName||"上海",this.op.originZoom)}};c.prototype.bindEvent=function(){var h=this;h.BMap.addEventListener("tilesloaded",h.tilesloaded);h.item.mapBox.on("click",".ol-area",function(){h.overlayClick(d(this),"area");f.sendMapLog("zf_map_district_marker")});h.item.mapBox.on("click",".ol-block",function(){h.overlayClick(d(this),"block");f.sendMapLog("zf_map_block_marker")});h.item.mapBox.on("click",".ol-commu",function(){h.overlayClick(d(this),"commu");f.sendMapLog("zf_map_comm_marker")});h.item.mapBox.on("mouseenter",".ol-commu",function(){h.mediator.commuHover("in",d(this).data("id"))}).on("mouseleave",".ol-commu",function(){h.mediator.commuHover("out",d(this).data("id"))});h.item.zoomIn.click(function(){var j=h.getZoom();if(j<h.op.maxZoom){h.BMap.setZoom(j+1)}f.sendMapLog("zf_map_zoomin")});h.item.zoomOut.click(function(){var j=h.getZoom();if(j>h.op.minZoom){h.BMap.setZoom(j-1)}f.sendMapLog("zf_map_zoomout")});d(".dis_tool").on("click",function(){h.mapDis.open();f.sendMapLog("zf_map_ruler")})};c.prototype.centerAndZoomLoad=function(){this.mediator.centerAndZoomLoaded();this.BMap.removeEventListener("tilesloaded",this.centerAndZoomLoad)};c.prototype.tilesloaded=function(){var j=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,offset:new BMap.Size(20,20)});var h=this;this.BMap.addEventListener("dragstart",this.dragstart);this.BMap.addEventListener("dragend",this.dragend);this.BMap.addEventListener("zoomstart",this.zoomstart);this.BMap.addEventListener("zoomend",this.zoomend);setTimeout(function(){h.BMap.addControl(j)},500);if(this.params.community_id!=-1){if(this.params.community_id!=-1){h.community_id=h.params.community_id}var k=h.mediator.buildAjaxParams();h.mediator.loadMapData(k,function(l){h.drawMapMarks(l)});h.mediator.loadPropData(k,function(l){h.mediator.refreshProps(l)})}else{this.zoomend()}this.BMap.removeEventListener("tilesloaded",this.tilesloaded);this.mapDis=new BMapLib.DistanceTool(h.BMap)};c.prototype.zoomstart=function(){this.mediator.abortAjax();this.autoLoadMap=true};c.prototype.dragstart=function(h){this.autoLoadMap=true;this.startDragGPtype=this.getGpTypeByZoom();if(!this.startDragPoint&&h){this.startDragPoint=h.pixel}};c.prototype.dragend=function(h){var j=this;var k=this.getGpTypeByZoom();if(k=="area"&&k==this.startDragGPtype){this.startDragGPtype="";return}this.startDragGPtype="";if(h){var l=this.judgeIfLoad(h.pixel);if(l){j.dealMapDefaultAct()}}else{this.startDragPoint=null;j.dealMapDefaultAct()}};c.prototype.judgeIfLoad=function(h){if(Math.abs(h.x-this.startDragPoint.x)>100||Math.abs(h.y-this.startDragPoint.y)>100){this.startDragPoint=null;return true}return false},c.prototype.zoomend=function(){var h=this;h.dealMapDefaultAct();h.clearOverlays("all");if(h.getGpTypeByZoom()=="area"){h.centerPoint.title=""}};c.prototype.dealMapDefaultAct=function(){var h=this;if(h.autoLoadMap===false){h.autoLoadMap=true;return}if(h.ifCommuNotINViewPort()){h.community_id=""}h.mediator.abortAjax();var j=h.mediator.buildAjaxParams();h.mediator.loadMapData(j,function(k){h.drawMapMarks(k)});if(h.community_id==""){j.p=1;j.maxp=99;h.mediator.loadPropData(j,function(k){h.mediator.refreshProps(k)})}};c.prototype.ifCommuNotINViewPort=function(){if(this.getGpTypeByZoom()=="commu"&&d("#"+this.community_id).length>0){var j=d("#"+this.community_id).data("lat"),h=d("#"+this.community_id).data("lng");if(this.BMap.getBounds().containsPoint(new BMap.Point(h,j))){return false}return true}return true};c.prototype.drawMapMarks=function(h){this.clearOverlays("all");if(this.centerPoint.title.length>0){this.drawOverlays([this.centerPoint],"mapcenter")}var j=this.getGpTypeByZoom();var k=h.val.region_list||h.val.block_list||h.val.community_list;this.drawOverlays(k,j)};c.prototype.reload=function(){this.community_id="";this.centerAndZoom(f.pubConfig.cityName||"上海","area")};c.prototype.overlayClick=function(o,q){var t=this;var p=o.data("lat");var r=o.data("lng");var j=new BMap.Point(r,p);var k=o.data("id");switch(q){case"area":var h=o.find(".ol-name").data("name");t.community_id="";var m=+f.pubConfig.zoomDefaultConfig.block;t.centerPoint={lat:p,lng:r,title:h};t.centerAndZoom({lat:p,lng:r},m);t.mediator.resetListHeadRoomNumTitle(h);break;case"block":var h=o.find(".ol-name").data("name");t.community_id="";var m=+f.pubConfig.zoomDefaultConfig.community;t.centerPoint={lat:p,lng:r,title:h};t.centerAndZoom({lat:p,lng:r},m);t.mediator.resetListHeadRoomNumTitle(h);break;case"commu":if(k==t.community_id){return}t.community_id=k;if(!_.contains(t.op.visited,k)){t.op.visited.push(k)}var l={id:o.data("id"),name:o.find(".ol-commu-name").text(),build_date:o.data("builddate"),lat:p,lng:r};this.focusCommu(k);var n=t.mediator.buildAjaxParams();n.p=1;n.maxp=99;t.mediator.loadPropData(n,function(u){t.mediator.refreshProps(u,{showHead:true,info:l})});break}};c.prototype.focusCommu=function(h){this.clearHighLight();this.hightlight(h)};c.prototype.centerAndZoom=function(j,l,m){var k=this,n;if(typeof l=="string"){n=k.op[l+"Z"]}else{n=l}if(typeof j!=="string"){j=new BMap.Point(j.lng,j.lat)}k.autoLoadMap=m===false?false:true;var h=k.getZoom();k.BMap.addEventListener("tilesloaded",k.centerAndZoomLoad);k.BMap.centerAndZoom(j,n);if(h==n){k.dragend()}};c.prototype.setMapCenter=function(k,j,h){this.centerPoint={lat:k,lng:j,title:h}};c.prototype.drawOverlays=function(n,m){var k=this;var l="area-tpl",k=this,j={x:0,y:0},h=function(){};switch(m){case"area":l="area-tpl";j={x:-46,y:-46};break;case"block":l="block-tpl";j={x:-37,y:-37};break;case"commu":l="commu-tpl";j={x:-31,y:-39};break;case"mapcenter":l="mapCenter-tpl";h=function(){var o=this.target.outerWidth();var p=this.target.outerHeight();this.target.css({marginLeft:0-o/2,marginTop:0-p})};break}_.each(n,function(p){var o=new BMap.Point(p.lng,p.lat);if(m=="commu"){var q=_.find(k.op.visited,function(r){return r==p.id});if(k.community_id==p.id){p.status="cur"}else{if(q){p.status="saw"}}}k.drawPoint(m,l,o,p,j,h)})};c.prototype.clearOverlays=function(j){var h=this;switch(j){case"all":h.BMap.clearOverlays();break;case"center":h.item.mapBox.find(".ol-loc").remove();break;case"points":h.item.mapBox.find(".ol-area,.ol-block,.ol-commu").remove();break;case"searchlogo":h.item.mapBox.find(".ol-tloc").remove();break;case"surround":h.item.mapBox.find(".layout_wrap").remove()}};c.prototype.drawPoint=function(o,n,h,p,l,k){var m=this;var j=new a(h,{target:_.template(d("#"+n).html())(p),shift:l||{x:0,y:0},done:k||function(){}});m.BMap.addOverlay(j)};c.prototype.getGpTypeByZoom=function(){var h=this,j=h.getZoom();if(j>=h.op.minZoom&&j<h.op.blockZ){return"area"}else{if(j>=h.op.blockZ&&j<h.op.ogCommuZ){return"block"}else{return"commu"}}};c.prototype.hightlight=function(){this.item.mapBox.find("#"+this.community_id).eq(0).removeClass("commu-saw").addClass("commu-cur")};c.prototype.clearHighLight=function(){this.item.mapBox.find(".commu-cur").removeClass("commu-cur").addClass("commu-saw")};c.prototype.traceAnces=function(n,l){var j=this,k=j.getGpTypeByZoom(),h=j.item.mapBox.find(".ol-"+k);if(l=="in"){var m=_.find(h,function(o){return d(o).data("id")==n.data(k+"id")});m&&d(m).addClass(k+"-over")}else{if(l=="out"){h.removeClass(k+"-over")}}};c.prototype.getZoom=function(){return this.BMap.getZoom()};c.prototype.getRange=function(){var h={},j=this.BMap.getBounds();h.sw_lat=j.getSouthWest().lat;h.sw_lng=j.getSouthWest().lng;h.ne_lat=j.getNorthEast().lat;h.ne_lng=j.getNorthEast().lng;return{lat:h.sw_lat+"_"+h.ne_lat,lng:h.sw_lng+"_"+h.ne_lng}};c.prototype.getAreaById=function(h){return this.op.areaList[h]};function a(h,k){var j=d.extend({target:"",shift:{x:0,y:0},done:function(){}},k);this.point=h;this.option=j;this.target=d(j.target);this.shift=j.shift;this.done=j.done}a.prototype=new BMap.Overlay();a.prototype.initialize=function(h){this.map=h;h.getPanes().markerPane.appendChild(this.target[0]);return this.target[0]};a.prototype.draw=function(){var j=this.map;var h=j.pointToOverlayPixel(this.point);this.target.css({left:h.x+this.shift.x+"px",top:h.y+this.shift.y+"px"});this.done()};function b(){this.node=d('<div class="layout_wrap"><div class="layout_detail"><h5 class="layout_title" title=""></h5><p class="distance_address"></p><div class="distance_tag"><span class="distance"></span></div><i class="layout_detail_down"></i></div></div>')}function e(k){var h={};var j={"1":[],"2":[],"3":[]};for(var l in k){switch(k[l]+""){case"1":j["1"].push(+l);break;case"2":j["2"].push(+l);break;case"3":j["3"].push(+l);break}}h.commu=_.min(j["3"]);h.block=_.min(j["2"]);return h}})(jQuery,APF.Namespace.register("ajk"),window);(function(a,c,b){c.mediator=function(d,e){this.ops=a.extend({},d);this.dataType="json";this.cacheMapData={};this.cachePropData={};this.params=e||{};this.init()};c.mediator.prototype={constructor:c.mediator,init:function(){this.search=new ajk.Search(this);this.select=new ajk.Select(this);this.list=new ajk.List(this);this.sort=new ajk.Sort(this);this.bmap=new ajk.Map(this,this.params)},loadMapData:function(f,e){f.ib=b.pubConfig.ib;f.et=b.pubConfig.token;f.bst=b.pubConfig.bst;var d=this;d.loadingMap&&d.loadingMap.abort();d.loadingMap=a.ajax({url:b.pubConfig.mapUrl,data:f,type:"GET",dataType:d.dataType,jsonp:"jsonpcallback"}).done(function(g){if(g.code==0||g.code==1){d.cacheMapData=g;if(e){e(g)}}})},loadPropData:function(f,e){f.ib=b.pubConfig.ib;f.et=b.pubConfig.token;f.bst=b.pubConfig.bst;var d=this;d.loadingProps&&d.loadingProps.abort();d.loadingProps=a.ajax({url:b.pubConfig.proplistUrl,data:f,type:"GET",dataType:d.dataType,jsonp:"jsonpcallback"}).done(function(g){if(g.code==0||g.code==1){d.cachePropData=g;if(e){e(g)}}})},getProps:function(f,e){f.ib=b.pubConfig.ib;f.et=b.pubConfig.token;f.bst=b.pubConfig.bst;var d=this;d.getProp=a.ajax({url:b.pubConfig.propUrl,data:f,type:"GET",dataType:d.dataType,jsonp:"jsonpcallback"}).done(function(g){if(g.code==0||g.code==1){d.cacheSinglePropData=g;if(e){e(g)}}})},abortAjax:function(){this.loadingProps&&this.loadingProps.abort();this.loadingMap&&this.loadingMap.abort()},refreshProps:function(d,e){this.list.refreshProps(d,e)},concatProps:function(d){this.list.concatProps(d)},getAjaxMapParams:function(){var d=this.bmap.getRange();var f=this.bmap.getZoom();var e=this.bmap.community_id;return{mapobj:{lat:d.lat,lng:d.lng,zoom:f},community_id:e}},getAjaxListParams:function(){return{p:this.list.p,maxp:this.list.maxp}},getAjaxSelectParams:function(){return this.select.getAllSelectVals()},getAjaxSortParams:function(){return{order_id:this.sort.order_id}},buildAjaxParams:function(){var f=this.getAjaxMapParams();var d=this.getAjaxListParams();var g=this.getAjaxSelectParams();var e=this.getAjaxSortParams();var h=a.extend({},d,g,e,f.mapobj);if(f.community_id!=""){h.community_id=f.community_id}return h},centerAndZoomToPoint:function(e,g,f,d){if(d){this.bmap.setMapCenter(e.lat,e.lng,d)}this.bmap.centerAndZoom(e,g,f)},conditionChange:function(){var e=this.select.getAllSelectVals();var d=this.search.getKwVal();if(e.price_id!=0||e.room_num!=0||e.rent_type!=0||e.price_min!=0||e.price_max!=0||e.lx_id.length>0||e.tag_id.length>0||e.orient_id.length>0){a(".filter-clear").show()}else{a(".filter-clear").hide()}},drawMarks:function(d){this.bmap.drawMapMarks(d)},clearMapMarks:function(d){this.bmap.clearOverlays(d)},focusCommu:function(d){this.bmap.focusCommu(d)},setMapCommunityId:function(d){this.bmap.community_id=d;if(!_.contains(this.bmap.op.visited,d)){this.bmap.op.visited.push(d)}},closeCommu:function(){this.bmap.dragend()},traceAnces:function(e,d){this.bmap.traceAnces(e,d)},resetListHeadRoomNumTitle:function(d){this.list.resetListHeadRoomNumTitle(d)},resetAll:function(){this.search.clearSearch();this.select.resetSelects();this.bmap.reload()},clearFilter:function(){this.select.resetSelects();this.bmap.dragend()},_clearSelects:function(){this.select.resetSelects()},centerAndZoomLoaded:function(){if(this.search.observerEvt){this.search.observerEvt()}},commuHover:function(d,e){if(d=="in"){this.list.hightFangItem(e)}else{this.list.blurFangItem(e)}}}})(jQuery,APF.Namespace.register("ajk"),window);